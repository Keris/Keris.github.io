[{"authors":["admin"],"categories":null,"content":"æˆ‘æ˜¯æœåˆ©å¼ºï¼Œä»Šå¹´30æœ‰ä½™ï¼Œè¿‡äº†10æœˆä¾¿æ˜¯31ï¼Œç”˜è‚ƒé™‡å—äººæ°ã€‚åœ¨è¿™ä¸ªåœ°æ–¹ï¼Œæˆ‘å¸Œæœ›è®°å½•è‡ªå·±ï¼Œä¾¿äºæˆ‘å›å¤´å†çœ‹çš„æ—¶å€™å‘ç°è‡ªå·±æœ‰æ‰€æˆé•¿ã€‚å„ä½çœ‹å®˜ï¼ˆå¯èƒ½ä¸€ä¸ªä¹Ÿæ²¡æœ‰ï¼‰å¦‚æœæœ‰æƒ³æ³•å¯ä»¥ç•™è¨€ï¼Œä¹Ÿå¯ä»¥å‘é‚®ä»¶ç»™æˆ‘ï¼Œç”šè‡³ç›´æ¥ç»™æˆ‘æ‰“ç”µè¯ã€‚\n","date":-62135596800,"expirydate":-62135596800,"kind":"taxonomy","lang":"zh","lastmod":-62135596800,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"https://keris.github.io/zh/authors/admin/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/zh/authors/admin/","section":"authors","summary":"æˆ‘æ˜¯æœåˆ©å¼ºï¼Œä»Šå¹´30æœ‰ä½™ï¼Œè¿‡äº†10æœˆä¾¿æ˜¯31ï¼Œç”˜è‚ƒé™‡å—äººæ°ã€‚åœ¨è¿™ä¸ªåœ°æ–¹ï¼Œæˆ‘å¸Œæœ›è®°å½•è‡ªå·±ï¼Œä¾¿äºæˆ‘å›å¤´å†çœ‹çš„æ—¶å€™å‘ç°è‡ªå·±æœ‰æ‰€æˆé•¿ã€‚å„ä½çœ‹å®˜ï¼ˆå¯èƒ½ä¸€ä¸ªä¹Ÿæ²¡æœ‰ï¼‰å¦‚æœæœ‰æƒ³æ³•å¯ä»¥ç•™è¨€ï¼Œä¹Ÿå¯ä»¥å‘é‚®ä»¶ç»™æˆ‘ï¼Œç”šè‡³ç›´æ¥ç»™æˆ‘æ‰“ç”µè¯ã€‚","tags":null,"title":"æœåˆ©å¼º","type":"authors"},{"authors":[],"categories":["æ•°å­¦"],"content":"import matplotlib.pyplot as plt import numpy as np import random  æ·ç¡¬å¸æ¨¡æ‹Ÿå®éªŒä¸€ å‡è®¾ä¸€æšç¡¬å¸è½åœ°åæ­£é¢æœä¸Šçš„æ¦‚ç‡ä¸º$p$ï¼Œè¿›è¡Œ$n$æ¬¡æŠ•æ·ã€‚é€šè¿‡æ¨¡æ‹Ÿå®éªŒéªŒè¯æ­£é¢æœä¸Šçš„æ¯”ä¾‹å°†éšç€æŠ•æ·æ¬¡æ•°çš„å¢åŠ è¶Šæ¥è¶Šæ¥è¿‘$p$ã€‚\n# è¿›è¡Œä¸€æ¬¡æŠ•æ·ï¼Œå¦‚æœè¿”å›Trueåˆ™è¡¨ç¤ºè·å¾—æ­£é¢ï¼Œå¦åˆ™åé¢ def make_a_toss(p): r = random.randint(1, 100) return r \u0026lt;= (100*p)  def simulate1(p, n=1000): heads = [] count = 0 for i in range(n): if make_a_toss(p): count += 1 heads.append(count) x = np.array(range(1, n + 1)) y = np.array(heads).astype(np.float32) / x plt.plot(x, y) plt.plot(x, np.ones(n) * p) plt.xlabel('The number of tosses') plt.ylabel('The proportion of heads') plt.title(f'p = {p}') plt.show()  # p=0.3 simulate1(0.3)  # p=0.03 simulate1(.03, 10000)  æ·ç¡¬å¸æ¨¡æ‹Ÿå®éªŒäºŒ å‡è®¾ä¸€æšç¡¬å¸è½åœ°åæ­£é¢æœä¸Šçš„æ¦‚ç‡ä¸º$p$ï¼Œè¿›è¡Œ$n$æ¬¡æŠ•æ·ï¼Œå®šä¹‰$X$ä¸ºæ­£é¢æœä¸Šçš„æ¬¡æ•°ã€‚é€šè¿‡æ¨¡æ‹Ÿå®éªŒéªŒè¯$X$å°†éšç€å®éªŒæ¬¡æ•°çš„å¢åŠ è¶Šæ¥è¶Šæ¥è¿‘$np$ã€‚\ndef moving_avg(x): result = np.array([.0] * len(x)) s = 0 for i, v in enumerate(x): s += v result[i] = s / (i + 1) return result  def simulate2(p, n=1000): def one_experiment(): heads = 0 for i in range(n): if make_a_toss(p): heads += 1 return heads heads = [] for _ in range(1000): # do 1000 experiments heads.append(one_experiment()) x = np.array(range(1, 1001)) y = moving_avg(heads) plt.plot(x, y) plt.plot(x, np.ones(1000) * p * n) plt.xlabel('The number of experiments') plt.ylabel('The number of heads') plt.title(f'p = {p}') plt.show()  # p=0.3, n=10 simulate2(0.3, 10)  # p=0.3, n=100 simulate2(0.3, 100)  # p=0.3, n=1000 simulate2(0.3, 1000)  ","date":1585994007,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1585994007,"objectID":"3cc9546f17a740944044c078399d7010","permalink":"https://keris.github.io/zh/post/coin-toss-experiment/","publishdate":"2020-04-04T17:53:27+08:00","relpermalink":"/zh/post/coin-toss-experiment/","section":"post","summary":"é€šè¿‡è®¡ç®—æœºå®éªŒç ”ç©¶æ¦‚ç‡","tags":["æ¦‚ç‡","Python","è®¡ç®—æœºæ¨¡æ‹Ÿå®éªŒ"],"title":"ç¡¬å¸æŠ•æ·æ¨¡æ‹Ÿå®éªŒ","type":"post"},{"authors":[],"categories":["æ•°å­¦"],"content":"åœ¨å¼€å§‹ä¹‹å‰æˆ‘æƒ³è¯´ä¸‹è¿™ä¸ªé…å›¾ï¼Œå®ƒæ˜¯æˆ‘ä»Šå¤©æ—©ä¸Šæ‹çš„ï¼Œé‡Œé¢æ˜¯è‡ªå·±åšçš„æ—©é¤ï¼Œç›˜ä¸­æ˜¯ä¸€ä¸ªé¦™è•‰åˆ‡äº†å››å°æ®µï¼Œä¸€ç‰‡åå¸é¢åŒ…å’Œäº›è®¸è…°æœï¼Œè€Œæ—è¾¹çš„ç¢—ä¸­æ˜¯ç‰›å¥¶æ³¡ç‡•éº¦ã€‚è¿™æ ·çš„æ­é…æˆ‘å·²ç»åƒäº†ä¸€å‘¨äº†ï¼Œæˆ‘å·²ç»æ„Ÿå—åˆ°äº†ç§¯æçš„å˜åŒ–ï¼Œè€ŒåŸå…ˆæˆ‘éƒ½æ˜¯ä¸åƒæ—©é¤æˆ–è€…åœ¨ä¸‹åœ°é“åé¡ºè·¯ä¹°ä¸€ä»½éº¦å½“åŠ³ã€‚\nç°åœ¨æˆ‘å›åˆ°æ­£é¢˜ä¸Šã€‚è¿™ä¸ªæ¦‚ç‡é—®é¢˜å¦‚ä¸‹ï¼š\n æœ‰ä¸€ä¸ªç›’å­ï¼Œé‡Œé¢æ”¾äº†10ä¸ªçƒï¼Œæ¯ä¸ªä¸Šé¢æ ‡äº†1åˆ°10ä¹‹é—´çš„æŸä¸ªæ•°å­—ï¼Œç°åœ¨è¿›è¡Œ3æ¬¡æœ‰æ”¾å›çš„æŠ½å–ï¼Œé—®ç¬¬ä¸€æ¬¡çš„å·å°äºç¬¬äºŒæ¬¡ï¼Œç¬¬äºŒæ¬¡åˆå°äºç¬¬ä¸‰æ¬¡çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ\n è¿™ä¸ªé—®é¢˜å…¶å®ä¸éš¾ï¼Œæˆ‘è‡ªè®¤ä¸ºæ™ºå•†ä¸­ç­‰åä¸‹ï¼Œè¿™ä¸ªé¢˜å½“æˆ‘åœ¨é¢è¯•æ—¶æ²¡æœ‰è§£å‡ºæ¥ğŸ˜ã€‚ä¸‹é¢æˆ‘å›é¡¾ä¸€ä¸‹å½“åˆçš„æƒ…æ™¯ã€‚\né¦–å…ˆï¼Œæˆ‘çŸ¥é“æ ·æœ¬ç©ºé—´$\\Omega$çš„å¤§å°ä¸º$|\\Omega| = 10^3 = 1000$ï¼Œå¦‚æœæˆ‘ä»¬å°†æ‰€æ±‚äº‹ä»¶è®°ä¸º$A$ï¼Œå¹¶ä¸”ç¬¬$i$æ¬¡æŠ½å–å¾—åˆ°çš„å·ä¸º$N_i(i=1,2,3)$ï¼Œåˆ™$A = \\{\\omega = (N_1, N_2, N_3) \\in \\Omega: N_1 \\lt N_2 \\lt N_3\\}$ã€‚ç°åœ¨è¦è®¡ç®—çš„æ˜¯$|A|$ï¼Œå³äº‹ä»¶$A$åŒ…å«äº†å¤šå°‘ä¸ªç‚¹ï¼Ÿ\næˆ‘é‡‡å–é€ä¸ªæ•°çš„ç­–ç•¥ï¼Œä½†ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“ã€‚$N_1$å¯ä»¥å–1åˆ°8ä¹‹é—´çš„æ•°å­—ï¼Œç„¶åå†è€ƒè™‘$N_2$çš„å–å€¼ï¼Œæœ€åæ˜¯$N_3$ã€‚\n$N_1 = 1$çš„æƒ…å†µ:\n1 / \\ 2 ... 9 / \\ \\ 3 ... 10 10  ä»¥ä¸Šç¤ºæ„å›¾ä¸­ï¼Œæ¯ä¸€å±‚è¡¨ç¤º$N_i(i=1,2,3)$çš„å–å€¼ï¼Œæœ€åè¦è®¡ç®—çš„æ˜¯å¶å­èŠ‚ç‚¹çš„æ•°ç›®ã€‚ å®¹æ˜“è®¡ç®—å½“$N_1 = 1$æ—¶ï¼Œå…±æœ‰$8 + 7 + \\cdots + 1 = \\frac{8 \\cdot (8 + 1)}{2} = 36$ä¸ªå¶å­ç»“ç‚¹ã€‚\nç±»ä¼¼åœ°ï¼Œ\n$N_1=2$æ—¶ï¼Œæœ‰$7 + \\cdots + 1 = \\frac{7 \\cdot (7 + 1)}{2} = 28$ï¼Œ\n\u0026hellip;\n$N_1=8$æ—¶ï¼Œæœ‰$1$ã€‚\næœ€åçš„ç­”æ¡ˆæ˜¯$|A| = 36 + 28 + 21 + 15 + 10 + 6 + 3 + 1 = 120$ï¼Œæ‰€ä»¥æ‰€æ±‚æ¦‚ç‡ä¸º$P = \\frac{|A|}{|\\Omega|} = \\frac{120}{1000} = .12$ã€‚\nä»¥ä¸Šç­”æ¡ˆæˆ‘åœ¨å½“æ—¶çš„æƒ…æ™¯ä¸‹é™äºæ—¶é—´ä»¥åŠæœ‰äº›è®¸ç´§å¼ ä¹Ÿæ²¡æœ‰ç»™å‡ºğŸ˜ã€‚\nå½“æ—¶æˆ‘è¿˜æœ‰ä¸ªæƒ³æ³•å°±æ˜¯ä½¿ç”¨ç¨‹åºçš„æ–¹æ³•è¿›è¡Œè®¡æ•°ï¼š\ncount = 0 for i in range(1, 9): # N1 for j in range(i+1, 11): # N2 for k in range(j+1, 11): # N3 count += 1  ä»¥ä¸Šç»“æœä¹Ÿä¼šç»™å‡ºæ­£ç¡®çš„ç»“æœå³120ã€‚è¿™ä¸ªæƒ³æ³•åœ¨å½“æ—¶è€ƒè™‘åˆ°åˆ‡å±ä¼šæœ‰ä¸å¥½çš„å½±å“ï¼Œæ²¡æœ‰å®è¡Œã€‚\nåæ¥ä¸€ç»†æƒ³ï¼Œä»¥ä¸Šä¸¤ç§æ–¹æ³•éƒ½ä¸æ˜¯æœ€ä¼˜çš„ï¼Œå†ä¸‰æ€è€ƒä¹‹åå¾—åˆ°äº†æœ€ä½³æ–¹æ³•ã€‚çœ‹æ¥è‡ªå·±è„‘å­ä¸å¥½ä½¿äº†ï¼Œå¯¹æ¦‚ç‡æ±‚è§£ç”Ÿç–ä¹Ÿæ˜¯åŸå› ã€‚\nä¸‹é¢è¯´è¯´æ€ä¹ˆæœ€ä¼˜æ±‚è§£ã€‚\näº‹ä»¶$A$ä¸­ä¸‰ä¸ªæ•°éƒ½ä¸åŒï¼Œä»10ä¸ªæ•°è¿ç»­3æ¬¡å–ä¸åŒå…±æœ‰$10 \\cdot 9 \\cdot 8 = 720$ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦$N_1 \\lt N_2 \\lt N_3$ï¼Œè€Œä¸‰ä¸ªæ•°çš„æ’åˆ—å…±æœ‰$3! = 6$ç§ï¼Œå…¶ä¸­åªæœ‰ä¸€ç§æ»¡è¶³è¦æ±‚ï¼Œæ‰€ä»¥$|A| = \\frac{720}{6} = 120$ã€‚\nè‡³æ­¤ï¼Œé—®é¢˜æ±‚è§£å®Œæ¯•ã€‚\n","date":1585976561,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1585976561,"objectID":"9e80aee326496a6611ed72fe381a5c74","permalink":"https://keris.github.io/zh/post/a-probability-problem/","publishdate":"2020-04-04T13:02:41+08:00","relpermalink":"/zh/post/a-probability-problem/","section":"post","summary":"æœ‰äº›é—®é¢˜æ²¡æœ‰æƒ³æ˜ç™½é‚£å°±æœ‰ç©ºå†æƒ³","tags":["æ¦‚ç‡"],"title":"ä¸€ä¸ªæ¦‚ç‡é—®é¢˜","type":"post"},{"authors":["æœåˆ©å¼º"],"categories":["æ•°å­¦"],"content":"æ£‹ç»æœ‰äº‘ï¼Œâ€œå®å¤±ä¸€å­ï¼Œå‹¿å¤±ä¸€å…ˆâ€ï¼Œå¯è§å…ˆæ‰‹çš„å¥½å¤„æ‰€åœ¨ã€‚ä¸ºäº†å»ºç«‹å¯¹å…ˆæ‰‹ç›´è§‚çš„ç†è§£ï¼Œæˆ‘ä»¬æ¥ç©ä¸€ä¸ªæ¸¸æˆï¼š\nä¸¤ä¸ªäººç©æŠ•æ·ç¡¬å¸çš„æ¸¸æˆï¼Œå…ˆæ·å‡ºæ­£é¢çš„äººè·èƒœï¼Œé‚£ä¹ˆä½ æ˜¯é€‰æ‹©å…ˆæ·è¿˜æ˜¯åæ·ï¼Ÿ\næ•°å­¦è§£æ³• å‡è®¾ç¡¬å¸æ˜¯å…¬å¹³çš„ï¼Œå³å‡ºç°æ­£é¢å’Œåé¢çš„æ¦‚ç‡ä¸€æ ·ï¼Œå‡ä¸º1/2ã€‚é‚£ä¹ˆï¼Œåœ¨å…ˆæ‰‹ä¸‹è·èƒœçš„æƒ…å†µæ˜¯ç¬¬næ¬¡æ·å¾—æ­£é¢ï¼Œå‰n-1æ¬¡éƒ½ä¸ºåé¢ï¼Œå…¶ä¸­nä¸ºå¥‡æ•°ã€‚æ‰€ä»¥å…ˆæ‰‹è·èƒœçš„æ¦‚ç‡ä¸º\n$$p(\\text{win}|\\text{first}) = \\sum_{k=0}^{\\infty}(\\frac{1}{2})^{2k + 1} = \\frac{2}{3}$$\nç›¸åï¼Œåœ¨åæ‰‹ä¸‹è·èƒœçš„æƒ…å†µæ˜¯ç¬¬næ¬¡æ·å¾—æ­£é¢ï¼Œå‰n-1æ¬¡å‡ä¸ºåé¢ï¼Œå…¶ä¸­nä¸ºå¶æ•°ã€‚æ‰€ä»¥ï¼Œåæ‰‹è·èƒœçš„æ¦‚ç‡ä¸º\n$$p(\\text{win}|\\text{second}) = \\sum_{k=1}^{\\infty}(\\frac{1}{2})^{2k} = \\frac{1}{3}$$\nå¯ä»¥å‘ç°ï¼Œå…ˆæ‰‹è·èƒœçš„æ¦‚ç‡ä¸º2/3ï¼Œè€Œåæ‰‹è·èƒœçš„æ¦‚ç‡ä¸º1/3ï¼Œè¿™å‘Šè¯‰æˆ‘ä»¬åœ¨ç”Ÿæ´»ä¸­æŠ“ä½å…ˆæœºï¼Œä¸»åŠ¨å‡ºå‡»å¾€å¾€æ›´èƒ½å–å¾—èƒœåˆ©ã€‚\næ¨¡æ‹Ÿæ³• å‰é¢æˆ‘ä»¬ç”¨æ•°å­¦çš„æ–¹æ³•è¿›è¡Œäº†æ±‚è§£ï¼Œä¸‹é¢æ¥çœ‹çœ‹å¦‚ä½•ç”¨ç¨‹åºæ¥æ¨¡æ‹Ÿï¼Œä¸ºæ­¤æˆ‘å†™äº†ä¸€ä¸ªPythonç¨‹åºï¼š\n# coding: utf-8 # filename: code.py # Author: Liqiang Du \u0026lt;keris.du@gmail.com\u0026gt; import random import numpy as np def simulate(n_games): \u0026quot;\u0026quot;\u0026quot; Simulate coin throwing game, the game is over when head appears. Args: n_games (int): the number of games. Returns: tuple: the first is the probability of win when first play, and the second the probability of win when second play. \u0026quot;\u0026quot;\u0026quot; win_count = np.array([0, 0]) for i in range(n_games): game_over = False n_tails = 0 while not game_over: x = random.randint(0, 1) # 1 indicates head and 0 tail if x == 1: game_over = True else: n_tails += 1 win_count[n_tails % 2] += 1 return win_count.astype(float) / n_games if __name__ == \u0026quot;__main__\u0026quot;: n_games = 100000 probs = simulate(n_games) print(probs)  ç¨‹åºçš„æ ¸å¿ƒéƒ¨åˆ†åœ¨äºsimulateï¼Œæ¯æ¬¡æ¸¸æˆï¼Œå‡ºç°æ­£é¢æ¸¸æˆå°±ç»“æŸï¼ŒåŒæ—¶è®°å½•åé¢å‡ºç°çš„æ¬¡æ•°ï¼Œå¦‚æœè¯¥æ¬¡æ•°ä¸ºå¶æ•°ï¼Œåˆ™å…ˆæ‰‹ä¸ºèµ¢ï¼Œå¦åˆ™åæ‰‹ä¸ºèµ¢ã€‚æœ€åç¨‹åºè¿”å›ä¸€ä¸ªå…ƒç¥–ï¼Œç¬¬ä¸€ä¸ªè¡¨ç¤ºå…ˆæ‰‹è·èƒœçš„æ¦‚ç‡ï¼Œç¬¬äºŒä¸ªä¸ºåæ‰‹è·èƒœçš„æ¦‚ç‡ã€‚\næˆ‘ä»¬è¿è¡Œä¸€ä¸‹ç¨‹åºçœ‹çœ‹ç»“æœï¼š\n$ python code.py [0.66436 0.33564]  æˆ‘ä»¬æ¨¡æ‹Ÿäº†10ä¸‡æ¬¡æ¸¸æˆï¼Œç¨‹åºè¿”å›çš„ç»“æœè·Ÿæ•°å­¦æ±‚è§£ç»“æœååˆ†æ¥è¿‘ã€‚\nè‡³æ­¤æ–‡ç« å°±å®Œäº†ã€‚åœ¨è¿™é‡Œæˆ‘é€šè¿‡ä¸€ä¸ªç®€å•çš„æ¸¸æˆè¯´æ˜äº†å…ˆæ‰‹çš„å¥½å¤„ï¼Œè¿™å‘Šè¯‰æˆ‘ä»¬ä¸€ä¸ªé“ç†ï¼Œä¸»åŠ¨å‡ºå‡»è·å¾—å…ˆæ‰‹ä¼˜åŠ¿å¾€å¾€æ›´èƒ½å¤ŸæˆåŠŸã€‚\n","date":1585029650,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1585029650,"objectID":"af1fe0f211643fc79c98f06da6a89d9a","permalink":"https://keris.github.io/zh/post/xianshou-throwing/","publishdate":"2020-03-24T14:00:50+08:00","relpermalink":"/zh/post/xianshou-throwing/","section":"post","summary":"å…ˆæ‰‹æ„å‘³ç€ä¸»åŠ¨ï¼Œä»æ¦‚ç‡ä¸Šè®²è·èƒœçš„å¯èƒ½æ€§ä¹Ÿæ›´å¤§","tags":["å…ˆæ‰‹","æ¦‚ç‡"],"title":"å…ˆæ‰‹ä¼˜åŠ¿","type":"post"},{"authors":["æœåˆ©å¼º"],"categories":["C/C++"],"content":"æœ€è¿‘å‚åŠ äº†ä¸€å®¶å…¬å¸çš„é¢è¯•ï¼Œå…¶ä¸­ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šâ€œå¦‚ä½•åœ¨Cè¯­è¨€ä¸­ç”Ÿæˆä¸€ä¸ªçœŸéšæœºæ•°ï¼Ÿâ€ æˆ‘å½“æ—¶æƒ³åˆ°çš„ç­”æ¡ˆæ˜¯ä½¿ç”¨rand()ï¼Œä½†rand()è¿”å›çš„å…¶å®æ˜¯ä¸€ä¸ªä¼ªéšæœºæ•°ï¼Œå€¼çš„èŒƒå›´æ˜¯[0, RAND_MAX]ã€‚å…¶ä¸­ï¼ŒRAND_MAXè·Ÿå…·ä½“çš„å®ç°æœ‰å…³ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ä¸åŒçš„å®ç°ä¸­å¯èƒ½æœ‰ä¸åŒçš„å€¼ã€‚\nä»¥ä¸Šä¾¿æ˜¯è¿™ç¯‡åšå®¢çš„èƒŒæ™¯ï¼Œä¹Ÿå¯ä»¥çœ‹å‡ºè‡ªå·±å¯¹éšæœºæ•°ç”Ÿæˆï¼ˆRNGï¼‰æŒæ¡çš„ä¹Ÿä¸å…¨é¢ï¼Œæ‰€ä»¥è¯•å›¾é€šè¿‡æ­¤æ–‡å¼¥è¡¥ä¸€ä¸‹çŸ­æ¿ã€‚\néšæœºæ•°çš„åº”ç”¨ éšæœºæ•°çš„åº”ç”¨æœ‰å¾ˆå¤šæ–¹é¢ï¼ŒåŒ…æ‹¬èµŒåšï¼Œç»Ÿè®¡é‡‡æ ·ï¼Œè®¡ç®—æœºä»¿çœŸï¼ŒåŠ å¯†ç­‰ã€‚\nçœŸéšæœºæ•°ä¸ä¼ªéšæœºæ•° ç®€å•æ¥è®²ï¼ŒçœŸéšæœºæ•°æ— æ³•é¢„æµ‹ï¼Œè€Œä¼ªéšæœºæ•°åœ¨çŸ¥é“ç§å­å€¼åä¾¿èƒ½å¤ç°ã€‚æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ç”Ÿæˆéšæœºæ•°çš„ä¸¤ç§æ–¹æ³•ã€‚\nåœ¨ç¬¬ä¸€ç§æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬æµ‹é‡æŸä¸ªè¢«è®¤ä¸ºæ˜¯éšæœºçš„ç‰©ç†ç°è±¡ï¼Œç„¶åè¡¥å¿æµ‹é‡è¿‡ç¨‹ä¸­å¯èƒ½çš„åå·®ã€‚è¿™ç§éšæœºæºåŒ…æ‹¬ç©ºæ°”å™ªå£°ï¼Œçƒ­å™ªå£°ä»¥åŠå…¶ä»–å¤–éƒ¨çš„ç”µç£å’Œé‡å­ç°è±¡ã€‚è¦äº§ç”Ÿä¸€ä¸ªéšæœºæ•°ï¼Œæˆ‘ä»¬éœ€è¦è·å–è¶³å¤Ÿçš„å¢’ï¼ˆentropyï¼‰ï¼Œä½†è·å–é€Ÿç‡å–å†³äºè¢«æµ‹é‡çš„ç‰©ç†ç°è±¡ã€‚å› æ­¤ï¼Œè¿™ç§äº§ç”Ÿéšæœºæ•°çš„æ–¹æ³•æ˜¯é˜»å¡çš„ï¼ˆblockingï¼‰çš„ï¼Œé€Ÿç‡å—é™çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨å¤§éƒ¨åˆ†Linuxå‘è¡Œç‰ˆä¸­ï¼Œä¼ªéšæœºè®¾å¤‡æ–‡ä»¶/dev/randomå°±ä¼šé˜»å¡ç›´åˆ°ä»ç¯å¢ƒè·å–åˆ°è¶³å¤Ÿçš„å¢’ã€‚ç”±äºè¿™ç§é˜»å¡è¡Œä¸ºï¼Œä»/dev/randomå¤§æ‰¹é‡è¯»ä»¥ä¾¿ç”¨éšæœºä½å¡«å……ç£ç›˜ç»å¸¸ä¼šå¾ˆæ…¢ï¼Œå°±æ˜¯å› ä¸ºå¢’æºæ˜¯é˜»å¡å‹çš„ã€‚\nåœ¨ç¬¬äºŒç§æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨è®¡ç®—çš„æ–¹æ³•æ¥ç”Ÿæˆæ˜æ˜¾éšæœºå€¼ç»„æˆçš„é•¿åºåˆ—ï¼Œä½†å®é™…ä¸Šç»“æœå®Œå…¨ç”±ä¸€ä¸ªè¾ƒçŸ­çš„åˆå§‹å€¼ç¡®å®šï¼Œè¿™ä¸ªåˆå§‹å€¼ä¹Ÿå«ç§å­å€¼ã€‚å› æ­¤ï¼Œæ•´ä¸ªçœ‹ä¼¼éšæœºçš„åºåˆ—åœ¨çŸ¥é“ç§å­å€¼çš„æƒ…å†µä¸‹èƒ½å¤Ÿè¢«å¤ç°ã€‚ç›¸æ¯”ç¬¬ä¸€ç§æ–¹æ³•ï¼Œç¬¬äºŒç§æ–¹æ³•æ˜¯éé˜»å¡ï¼ˆnon-blockingï¼‰çš„ï¼Œæ‰€ä»¥å…¶ç”Ÿæˆé€Ÿç‡ä¸å—å¤–éƒ¨äº‹ä»¶çš„å½±å“ã€‚\nåœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¸€äº›ç³»ç»Ÿé‡‡å–æ··åˆçš„åŠæ³•ï¼Œå³åœ¨å¯ç”¨çš„æ—¶å€™é‡‡ç”¨è‡ªç„¶æºæä¾›çš„éšæœºæ€§ï¼Œå¦åˆ™ä½¿ç”¨å‘¨æœŸæ€§é‡æ–°è®¾ç½®ç§å­ã€è½¯ä»¶åŸºäºçš„å¯†ç å®‰å…¨çš„ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ï¼ˆCSPRNGsï¼‰ã€‚\nåœ¨è¿™é‡Œå°ç»“ä¸€ä¸‹ï¼šçœŸéšæœºæ•°ä¾èµ–äºæ”¶é›†è‡ªç„¶å‘ç”Ÿçš„å¢’ï¼Œæœ‰äº†è¶³å¤Ÿçš„å¢’æ–¹å¯ç”Ÿæˆéšæœºæ•°ï¼Œå› æ­¤æ˜¯é˜»å¡çš„ï¼Œé€Ÿç‡æœ‰é™çš„ï¼›ä¼ªéšæœºæ•°ä½¿ç”¨è®¡ç®—æ–¹æ³•äº§ç”Ÿï¼Œåœ¨çŸ¥é“ç§å­å€¼åèƒ½å¤Ÿå¤ç°ï¼Œéé˜»å¡ï¼Œé€Ÿç‡ä¸å—é™ã€‚\nCè¯­è¨€ä¸­çš„éšæœºæ•°ç”Ÿæˆ åœ¨Cè¯­è¨€ä¸­ï¼Œæ ‡å‡†åº“stdlib.hæä¾›äº†ä¸¤ä¸ªå‡½æ•°int rand(void)å’Œvoid srand(unsigned)æ¥å¸®åŠ©æˆ‘ä»¬ç”Ÿæˆä¼ªéšæœºæ•°ã€‚\nrand()è¿”å›ä¸€ä¸ªä½äºåŒºé—´[0, RAND_MAX]çš„æ•´æ•°ï¼ŒRAND_MAXåœ¨ä¸åŒçš„å®ç°ä¸­å¯èƒ½ä¸åŒï¼Œä½†è¢«ä¿è¯è‡³å°‘æ˜¯32767ã€‚åœ¨è°ƒç”¨rand()å‰ï¼Œå¦‚æœæˆ‘ä»¬ä¸è®¾ç½®ç§å­ï¼Œç³»ç»Ÿé»˜è®¤æˆ‘ä»¬è®¾ç½®ç§å­ä¸º1ï¼Œå³è°ƒç”¨äº†srand(1)ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ¯æ¬¡è¿è¡Œå°†ä¼šäº§ç”ŸåŒæ ·çš„å€¼ï¼Œä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­ï¼š\n#include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; int main() { int num = rand(); printf(\u0026quot;Random number: %d\\n\u0026quot;, num); return 0; }  æˆ‘ä»¬ç¼–è¯‘ä»¥ä¸Šä»£ç å¹¶è¿è¡Œ5æ¬¡ï¼š\n$ gcc gen_rand.c \u0026amp;\u0026amp; for i in `seq 1 5`;do ./a.out;done Random number: 16807 Random number: 16807 Random number: 16807 Random number: 16807 Random number: 16807  å¯ä»¥çœ‹åˆ°ï¼Œç¨‹åºåœ¨æ¯æ¬¡è¿è¡Œæ—¶å‡ç”Ÿæˆäº†åŒæ ·çš„å€¼ï¼Œè¿™æ˜¯å› ä¸ºç§å­å€¼å‡ä¸º1ã€‚\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†çœ‹çœ‹æ‰‹åŠ¨è®¾ç½®ç§å­çš„æƒ…å†µï¼š\n#include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;time.h\u0026gt; int main() { srand((unsigned)time(0)); // use current time as seed int num = rand(); printf(\u0026quot;Random number: %d\\n\u0026quot;, num); return 0; }  è¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬å°†ç§å­è®¾ä¸ºå½“å‰æ—¶é—´ã€‚åŒæ ·åœ°ï¼Œæˆ‘ä»¬ç¼–è¯‘å¹¶è¿è¡Œ5æ¬¡ï¼š\n$ gcc gen_rand1.c \u0026amp;\u0026amp; for i in `seq 1 5`;do ./a.out;done Random number: 7890298 Random number: 7890298 Random number: 7890298 Random number: 7890298 Random number: 7890298  ç»“æœçœ‹ä¼¼è·Ÿå‰é¢æ²¡æœ‰ä¸åŒï¼Œå› ä¸º5æ¬¡è°ƒç”¨ä¾ç„¶ç”Ÿæˆäº†åŒæ ·çš„å€¼ã€‚å…¶å®ï¼Œè¿™ä¸ªå·®åˆ«å¾ˆç»†å¾®ï¼Œæˆ‘ä»¬å°†ç§å­è®¾ä¸ºå½“å‰æ—¶é—´ï¼Œä½†åªæœ‰åœ¨é‡æ–°ç¼–è¯‘æ—¶æ‰èƒ½æœ‰ä¸åŒçš„ç§å­å€¼ã€‚å› æ­¤ï¼Œä¸¤æ¬¡ç¼–è¯‘ä¹‹é—´ç”Ÿæˆçš„å€¼åº”è¯¥ä¸åŒï¼š\n$ gcc gen_rand1.c \u0026amp;\u0026amp; ./a.out Random number: 12713907 $ gcc gen_rand1.c \u0026amp;\u0026amp; ./a.out Random number: 12747521  C++ä¸­çš„éšæœºæ•°ç”Ÿæˆ åœ¨C++ä¸­ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥ä½¿ç”¨rand()å’Œsrand()æ¥ç”Ÿæˆéšæœºæ•°ï¼Œä½†è¿™å·²ç»ä¸æ˜¯æ ‡å‡†æ¨èçš„åšæ³•ï¼Œç›¸åæˆ‘ä»¬åº”è¯¥ä½¿ç”¨randomåº“æä¾›çš„å·¥å…·ç±»æ¥ç”Ÿæˆéšæœºæ•°ã€‚\nä¸‹é¢ç»™å‡ºC++ç‰ˆæœ¬çš„ä»£ç ï¼Œè¿è¡Œç»“æœè·ŸCè¯­è¨€åˆ«æ— äºŒè‡´ï¼Œä¸å†èµ˜è¿°ã€‚\n#include \u0026lt;iostream\u0026gt; #include \u0026lt;cstdlib\u0026gt; #include \u0026lt;ctime\u0026gt; using namespace std; int main() { // srand((unsigned)time(nullptr)); // use current time as seed int r = rand(); cout \u0026lt;\u0026lt; \u0026quot;Random number between 0 and \u0026quot; \u0026lt;\u0026lt; RAND_MAX \u0026lt;\u0026lt; \u0026quot; :\u0026quot;; cout \u0026lt;\u0026lt; r \u0026lt;\u0026lt; '\\n'; return 0; }  æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨randomåº“æä¾›çš„å·¥å…·æ¥ç”Ÿæˆéšæœºæ•°ã€‚randomåº“æä¾›äº†ä¸¤ç§ç±»å‹çš„ç±»ï¼š\n å‡åŒ€åˆ†å¸ƒéšæœºä½ç”Ÿæˆå™¨ï¼ˆURBGsï¼‰ï¼Œæ—¢åŒ…æ‹¬ä¼ªéšæœºæ•°ç”Ÿæˆå’ŒçœŸéšæœºæ•°ç”Ÿæˆï¼ˆå¦‚æœå¯ç”¨ï¼‰ éšæœºæ•°åˆ†å¸ƒ  è¯¦ç»†çš„ä¿¡æ¯è¯·å‚è§ https://en.cppreference.com/w/cpp/numeric/randomã€‚\nä¸‹é¢ç»™å‡ºä¸€ä¸ªä½¿ç”¨éšæœºæ•°å¼•æ“ç”Ÿæˆéšæœºæ•°çš„ä¾‹å­ï¼š\n#include \u0026lt;iostream\u0026gt; #include \u0026lt;random\u0026gt; using namespace std; int main() { random_device rd; default_random_engine e1(rd()); cout \u0026lt;\u0026lt; e1() \u0026lt;\u0026lt; endl; return 0; }  æˆ‘ä»¬ç¼–è¯‘ä»¥ä¸Šä»£ç ï¼Œå¹¶è¿è¡Œ5æ¬¡ï¼š\n$ g++ main.cc -std=c++17 \u0026amp;\u0026amp; for i in `seq 1 5`;do ./a.out;done 17429349 872858569 1540494345 40333012 95212997  ä»è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ç¼–è¯‘ä»£ç ä¸€æ¬¡ï¼Œå¤šæ¬¡è¿è¡Œï¼Œæ¯æ¬¡ä¼šäº§ç”Ÿä¸åŒçš„å€¼ï¼Œåºåˆ—å˜å¾—ä¸å¯é¢„æµ‹ã€‚\næ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç”Ÿæˆçš„éšæœºæ•°è½¬æ¢åˆ°æŸä¸ªé—­åŒºé—´çš„å‡åŒ€åˆ†å¸ƒæˆ–è€…æ­£æ€åˆ†å¸ƒï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªå‡åŒ€åˆ†å¸ƒçš„ä¾‹å­ï¼š\n#include \u0026lt;iostream\u0026gt; #include \u0026lt;iomanip\u0026gt; #include \u0026lt;string\u0026gt; #include \u0026lt;random\u0026gt; #include \u0026lt;map\u0026gt; using namespace std; int main() { random_device rd; default_random_engine e1(rd()); uniform_int_distribution\u0026lt;int\u0026gt; dis(1, 6); cout \u0026lt;\u0026lt; dis.min() \u0026lt;\u0026lt; endl; cout \u0026lt;\u0026lt; dis.max() \u0026lt;\u0026lt; endl; map\u0026lt;int, int\u0026gt; hist; for (int i = 0; i != 10000; i++) { hist[dis(e1)]++; } for (auto[num, count] : hist) { cout \u0026lt;\u0026lt; num \u0026lt;\u0026lt; ' ' \u0026lt;\u0026lt; string(count / 200, '*') \u0026lt;\u0026lt; '\\n'; } return 0; }  ç¼–è¯‘ä»¥ä¸Šä»£ç å¹¶è¿è¡Œï¼Œç»“æœå¦‚ä¸‹ï¼š\n$ g++ -std=c++17 main.cc \u0026amp;\u0026amp; ./a.out 1 6 1 ******** 2 ******** 3 ******* 4 ******** 5 ******** 6 ********  æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬è¾“å‡ºå‡åŒ€åˆ†å¸ƒå¯èƒ½ç”Ÿæˆçš„æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼Œç”±äºæˆ‘ä»¬è€ƒè™‘çš„æ˜¯é—­åŒºé—´[1, 6]ä¸Šçš„å‡åŒ€åˆ†å¸ƒï¼Œæ˜¾ç„¶æœ€å°å€¼å’Œæœ€å¤§å€¼åˆ†åˆ«ä¸º1å’Œ6ã€‚ç„¶åæˆ‘ä»¬å°†äº§ç”Ÿçš„éšæœºæ•°è½¬æ¢åˆ°åŒºé—´ä¸Šçš„æŸä¸ªå€¼ï¼Œå¹¶ç»Ÿè®¡å‡ºç°æ¬¡æ•°ã€‚æœ€åï¼Œæˆ‘ä»¬ç»˜åˆ¶ç›´æ–¹å›¾ï¼Œä»ç»“æœæ¥çœ‹ï¼Œæ¯ä¸ªå€¼å‡ºç°çš„æ¬¡æ•°åŸºæœ¬ä¸€æ ·å¤šï¼ˆæˆ‘ä»¬è¿›è¡Œäº†10000æ¬¡å®éªŒï¼ï¼‰ã€‚\n","date":1584503154,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1584503154,"objectID":"3046ee01433c6af0f1910ac1b8b8c2a1","permalink":"https://keris.github.io/zh/post/random-number-generator/","publishdate":"2020-03-18T11:45:54+08:00","relpermalink":"/zh/post/random-number-generator/","section":"post","summary":"åœ¨C/C++ä¸­å¦‚ä½•ç”ŸæˆçœŸéšæœºæ•°","tags":["C/C++","PRNGs","random-number-generator","éšæœºæ•°ç”Ÿæˆ"],"title":"éšæœºæ•°ç”Ÿæˆ","type":"post"},{"authors":["æœåˆ©å¼º"],"categories":["C/C++"],"content":"æœ€è¿‘çœ‹C++ç¼–ç¨‹è¯­è¨€ç¬¬å››ç‰ˆ1ï¼Œé˜…è¯»åˆ°çº¿ç¨‹è¿™ä¸€ç« ï¼Œä½œè€…åœ¨è®²è§£mutexæ—¶ç»™å‡ºäº†ä¸€ä¸ªä¾‹å­ï¼Œè‡ªå·±ç…§ç€å†™äº†ä¸€ä¸ªå‘ç°è·‘ä¸é€šï¼Œç ”ç©¶åå‘ç°å¯¹å˜å‚æ¨¡ç‰ˆç†è§£ä¸å¤Ÿï¼Œä¾¿å†™äº†è¿™ç¯‡æ–‡ç« ã€‚\né¦–å…ˆï¼Œæˆ‘ä»¬çœ‹çœ‹ä¹¦æœ¬ä¸Šçš„ä¾‹å­ï¼š\nmutex cout_mutex; template\u0026lt;typename Arg, typename... Args\u0026gt; void write(Arg a, Args... tail) { cout_mutex.lock(); cout \u0026lt;\u0026lt; a; write(tail...); cout_mutex.unlock(); }  è¿™ä¸ªä¾‹å­æ—¨åœ¨è¯´æ˜deadlockï¼Œå› ä¸ºæˆ‘ä»¬åœ¨writeå‡½æ•°ä¸­é€’å½’è°ƒç”¨å®ƒï¼Œè€Œè¯¥å‡½æ•°åœ¨è¿›è¡Œè¾“å‡ºå‰éœ€è¦è·å–äº’æ–¥å˜é‡ã€‚ä¸ºäº†è§£é™¤æ­»é”ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨recursive_mutexï¼Œè¿™ç§ç±»å‹çš„mutexå…è®¸é€’å½’åœ°è·å–ã€‚\nåŸºäºä»¥ä¸Šæƒ³æ³•ï¼Œæˆ‘å†™äº†ä¸€ä¸ªä¾‹å­æ¥è¿›è¡Œæµ‹è¯•ï¼š\n#include \u0026lt;iostream\u0026gt; #include \u0026lt;mutex\u0026gt; using namespace std; recursive_mutex cout_mutex; template\u0026lt;typename Arg, typename... Args\u0026gt; void write(Arg a, Args... tail) { cout_mutex.lock(); cout \u0026lt;\u0026lt; a; write(tail...); cout_mutex.unlock(); } int main(int argc, char* argv[]) { write(\u0026quot;hello,\u0026quot;, \u0026quot;world\u0026quot;); return 0; }  å½“æˆ‘å°è¯•ç¼–è¯‘ä»¥ä¸Šä»£ç å´å‘ç°æŠ¥å‡ºé”™è¯¯ï¼š\n$ g++ test.cc -std=c++17 test.cpp:12:6: error: no matching function for call to 'write' write(tail...); ^~~~~ test.cpp:12:6: note: in instantiation of function template specialization 'write\u0026lt;const char *\u0026gt;' requested here test.cpp:17:6: note: in instantiation of function template specialization 'write\u0026lt;const char *, const char *\u0026gt;' requested here write(\u0026quot;hello,\u0026quot;, \u0026quot;world\u0026quot;); ^ test.cpp:9:7: note: candidate function template not viable: requires at least argument 'a', but no arguments were provided void write(Arg a, Args... tail) { ^ 1 error generated.   åœ¨ç¼–è¯‘æ—¶æˆ‘ä½¿ç”¨äº†c++17æ ‡å‡†ã€‚\n å¯ä»¥çœ‹åˆ°ï¼Œç¼–è¯‘å™¨æŠ¥å‘Šäº†ä¸€ä¸ªé”™è¯¯ï¼Œå¯¹'write'çš„è°ƒç”¨æ²¡æœ‰åŒ¹é…çš„å‡½æ•°ï¼Œè¿™æ˜¯ä¸ºä½•ï¼Ÿ\nå¯¹äºä»¥ä¸Šçš„å®ç°ï¼Œwrite(\u0026quot;hello,\u0026quot;, \u0026quot;world\u0026quot;)å¯ä»¥æ‹†åˆ†æˆï¼š\n è¾“å‡ºhello,ï¼Œæ­¤æ—¶tailåŒ…å«ä¸€ä¸ªå‚æ•°å³world è¾“å‡ºworldï¼Œæ­¤æ—¶tailä¸ºç©ºï¼Œä½†writeå‡½æ•°è‡³å°‘éœ€è¦ä¸€ä¸ªå‚æ•°ï¼Œæ‰€ä»¥äº§ç”Ÿä»¥ä¸Šé”™è¯¯ã€‚  ä¸‹é¢æˆ‘ä»¬å¢åŠ ä¸€ä¸ªæ¥å—ç©ºå‚æ•°çš„writeå‡½æ•°æ¥éªŒè¯ï¼š\n#include \u0026lt;iostream\u0026gt; #include \u0026lt;mutex\u0026gt; using namespace std; recursive_mutex cout_mutex; void write() { cout \u0026lt;\u0026lt; \u0026quot;\u0026quot;; // output nothing } template\u0026lt;typename Arg, typename... Args\u0026gt; void write(Arg a, Args... tail) { cout_mutex.lock(); cout \u0026lt;\u0026lt; a; write(tail...); cout_mutex.unlock(); } int main(int argc, char* argv[]) { write(\u0026quot;hello,\u0026quot;, \u0026quot;world\u0026quot;); return 0; }  åœ¨è¿›è¡Œä¸Šè¿°æ“ä½œåï¼Œä»£ç ç¼–è¯‘é€šè¿‡ï¼Œè¿è¡Œåè¾“å‡ºä»¥ä¸‹ç»“æœï¼š\n$ ./a.out $ hello,world    è‹±æ–‡åä¸ºï¼šThe C++ Programming Language, 4th Edition. ä½œè€…ä¸ºBjarne Stroustrup. \u0026#x21a9;\u0026#xfe0e;\n   ","date":1584411182,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1584411182,"objectID":"b6852d39bb74bd2ba029595151199bbf","permalink":"https://keris.github.io/zh/post/variadic-template/","publishdate":"2020-03-17T10:13:02+08:00","relpermalink":"/zh/post/variadic-template/","section":"post","summary":"å¦‚é¢˜","tags":["C++","variadic-template","å˜å‚æ¨¡ç‰ˆ"],"title":"ä¸€ä¸ªä¾‹å­å¯¼å‘çš„å¯¹å˜å‚æ¨¡ç‰ˆçš„ç†è§£","type":"post"},{"authors":["æœåˆ©å¼º"],"categories":["æœºå™¨å­¦ä¹ "],"content":"ç›®å½•    ä¸¤ç§ç±»å‹çš„é”™è¯¯ æ¨¡å‹å¤æ‚å›¾ KæŠ˜äº¤å‰éªŒè¯ å­¦ä¹ æ›²çº¿     ä¸¤ç§ç±»å‹çš„é”™è¯¯ åœ¨é€‰æ‹©æ¨¡å‹æ—¶æˆ‘ä»¬å¯èƒ½çŠ¯ä¸¤ç§ç±»å‹çš„é”™è¯¯ï¼Œé€‰æ‹©è¿‡äºç®€å•çš„æ¨¡å‹æˆ–è€…è¿‡äºå¤æ‚çš„æ¨¡å‹ï¼Œå‰è€…å¯¹åº”æ¬ æ‹Ÿåˆï¼Œåè€…å¯¹åº”è¿‡æ‹Ÿåˆã€‚\næ¬ æ‹Ÿåˆå‘ç”Ÿæ—¶ï¼Œæ¨¡å‹å…·æœ‰é«˜åå·®ï¼ˆhigh biasï¼‰ï¼Œæ¨¡å‹ä¸èƒ½å¾ˆå¥½åœ°æ‹Ÿåˆè®­ç»ƒé›†ï¼›è¿‡æ‹Ÿåˆå‘ç”Ÿæ—¶ï¼Œæ¨¡å‹å…·æœ‰é«˜æ–¹å·®ï¼ˆhigh varianceï¼‰ï¼Œæ¨¡å‹è¯•å›¾å¯¹è®­ç»ƒæ•°æ®è¿›è¡Œè®°å¿†è€Œä¸æ˜¯å­¦ä¹ å…¶ç‰¹ç‚¹ï¼Œåœ¨è®­ç»ƒé›†ä¸Šè¡¨ç°å¾ˆå¥½ï¼Œä½†åœ¨æµ‹è¯•é›†ä¸Šè¡¨ç°å¾ˆå·®ã€‚\nä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸ªæ¬ æ‹Ÿåˆçš„ä¾‹å­ï¼š\n   åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå·¦è¾¹çš„æ¨¡å‹ä½¿ç”¨ä¸€ä¸ªäºŒæ¬¡æ›²çº¿å»æ‹Ÿåˆæ•°æ®ç‚¹ï¼Œè€Œå³è¾¹åˆ™æ˜¯ä½¿ç”¨ç›´çº¿å»æ‹Ÿåˆï¼Œå¯ä»¥å‘ç°ç›´çº¿å¹¶ä¸èƒ½å¾ˆå¥½åœ°æ‹Ÿåˆæ•°æ®ï¼Œè¿™å°±æ˜¯æ¬ æ‹Ÿåˆçš„æƒ…å½¢ã€‚\näº†è§£äº†æ¬ æ‹Ÿåˆï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªè¿‡æ‹Ÿåˆçš„ä¾‹å­ï¼š\n   Overfitting   åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå·¦è¾¹çš„æ¨¡å‹ä½¿ç”¨ä¸€ä¸ªäºŒæ¬¡æ›²çº¿å»æ‹Ÿåˆæ•°æ®ç‚¹ï¼Œè€Œå³è¾¹çš„æ¨¡å‹è¯•å›¾å¯¹è®­ç»ƒé›†è¿›è¡Œè®°å¿†ï¼Œå› è€Œå®ƒåœ¨è®­ç»ƒé›†ä¸Šè¡¨ç°å¾ˆå¥½ï¼Œä½†å®ƒæ²¡æœ‰å­¦ä¹ åˆ°æ•°æ®çš„è‰¯å¥½å±æ€§ä»¥å¾ˆå¥½åœ°æ³›åŒ–åˆ°æµ‹è¯•é›†ï¼Œè¿™å°±æ˜¯è¿‡æ‹Ÿåˆçš„æƒ…å½¢ã€‚\nå‰é¢ä¸¤ä¸ªä¾‹å­å±äºå›å½’æ¨¡å‹ï¼Œåœ¨åˆ†ç±»æ¨¡å‹ä¸­æˆ‘ä»¬ä¹Ÿä¼šçœ‹åˆ°æ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆã€‚\nåˆ†ç±»æ¨¡å‹ä¸­çš„æ¬ æ‹Ÿåˆï¼š\n   Underfitting in a Classification Model   åˆ†ç±»æ¨¡å‹ä¸­çš„è¿‡æ‹Ÿåˆï¼š\n   Overfitting in a Classification Model   æœ€åï¼Œæˆ‘ä»¬æ€»ç»“ä¸€ä¸‹ï¼š\n   Tradeoff between High Bias and High Variance   æ¨¡å‹å¤æ‚å›¾ åœ¨å‰é¢ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å­¦ä¹ äº†æ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆï¼Œåœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬äº†è§£ä¸€ä¸‹æ¨¡å‹å¤æ‚å›¾ï¼Œå³è¯„ä¼°æŒ‡æ ‡éšç€æ¨¡å‹å¤æ‚æ€§çš„æå‡å¦‚ä½•å˜åŒ–ã€‚\n   Model Complexity Graph   åœ¨ä¸Šé¢è¿™ä¸ªå›¾ä¸­ï¼Œå·¦ä¾§å¯¹åº”æ¬ æ‹Ÿåˆçš„æƒ…å½¢ï¼Œæ­¤æ—¶æ¨¡å‹åœ¨è®­ç»ƒé›†å’ŒéªŒè¯é›†ä¸Šéƒ½å…·æœ‰è¾ƒå¤§çš„è¯¯å·®ï¼›å³ä¾§å¯¹åº”è¿‡æ‹Ÿåˆçš„æƒ…å½¢ï¼Œæ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šå…·æœ‰è¾ƒå°çš„è¯¯å·®ï¼Œè€Œåœ¨éªŒè¯é›†ä¸Šå…·æœ‰è¾ƒå¤§çš„è¯¯å·®ï¼›åœˆèµ·æ¥çš„é‚£ä¸ªåœ°æ–¹å¯¹åº”åˆšåˆšå¥½çš„æƒ…å½¢ï¼Œæ­¤æ—¶æ¨¡å‹åœ¨è®­ç»ƒé›†å’ŒéªŒè¯é›†ä¸Šéƒ½å…·æœ‰è¾ƒå°çš„è¯¯å·®ï¼Œè¿‡äº†è¿™ä¸ªç‚¹ï¼Œåœ¨è®­ç»ƒé›†ä¸Šçš„è¯¯å·®æŒç»­å‡å°ï¼Œä½†åœ¨éªŒè¯é›†ä¸Šçš„è¯¯å·®å¼€å§‹ä¸æ–­å˜å¤§ã€‚\nå¯èƒ½ä½ æ³¨æ„åˆ°äº†ä¸€ä¸ªæ–°æ¦‚å¿µï¼ŒéªŒè¯é›†ï¼Œä¸ºä»€ä¹ˆä¸ç”¨æµ‹è¯•é›†ï¼Ÿ\nåœ¨æ„å»ºæœºå™¨å­¦ä¹ æ¨¡å‹æ—¶ï¼Œä¸€ä¸ªåŠ¡å¿…è¦åšæŒçš„åŸåˆ™æ˜¯æµ‹è¯•é›†åªèƒ½ç”¨äºæœ€åçš„æ¨¡å‹è¯„ä¼°ï¼Œè€Œä¸èƒ½å‚ä¸æ¨¡å‹è®­ç»ƒã€‚é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆé€‰æ‹©ä¸€ä¸ªå¥½çš„æ¨¡å‹ï¼ŒéªŒè¯é›†å³ç”¨äºæ­¤ç›®çš„ã€‚\né‚£æ€ä¹ˆå¾—åˆ°éªŒè¯é›†ï¼Ÿä¸‹å›¾å¯ä»¥ç»™ä½ ä¸€ä¸ªç›´è§‚çš„ç†è§£ï¼š\n   Cross Validation   å¯ä»¥çœ‹åˆ°ï¼Œè®­ç»ƒé›†ä¸­çš„ä¸€å°éƒ¨åˆ†è¢«ç”¨æ¥ä½œä¸ºéªŒè¯é›†ï¼Œå€ŸåŠ©éªŒè¯é›†æˆ‘ä»¬è¯„ä¼°æ¨¡å‹æ˜¯å¦æ¬ æ‹Ÿåˆï¼Œè¿‡æ‹Ÿåˆæˆ–è€…åˆšåˆšå¥½ï¼Œå³éªŒè¯é›†ç”¨æ¥è¿›è¡Œå†³ç­–ï¼Œå¸®åŠ©æˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªå¥½çš„æ¨¡å‹ã€‚æœ€åï¼Œæµ‹è¯•é›†ç”¨äºæœ€ç»ˆçš„æ¨¡å‹è¯„ä¼°ã€‚\nKæŠ˜äº¤å‰éªŒè¯ å¯èƒ½ä½ æ³¨æ„åˆ°äº†ï¼Œç”±äºä»è®­ç»ƒé›†ä¸­åˆ’å‡ºäº†ä¸€å°éƒ¨åˆ†ä½œä¸ºéªŒè¯é›†ï¼Œè¿™ä½¿å¾—è®­ç»ƒæ•°æ®å˜å°‘äº†ï¼Œè¿™ä¼šå¯¹æ¨¡å‹äº§ç”Ÿä¸åˆ©å› ç´ ï¼Œä¸ºæ­¤ä½ éœ€è¦ä½¿ç”¨KæŠ˜äº¤å‰éªŒè¯ã€‚\n   åœ¨ä¸Šé¢è¿™ä¸ªå›¾ä¸­ï¼Œæˆ‘ä»¬æœ‰12ä¸ªæ ·æœ¬ï¼Œå…¶ä¸­å®å¿ƒçš„ç”¨äºè®­ç»ƒï¼Œç©ºå¿ƒçš„ç”¨äºæµ‹è¯•1ã€‚è¿™æ˜¯ä¸€ä¸ª4æŠ˜äº¤å‰éªŒè¯ï¼Œæ¯æ¬¡å…¶ä¸­ä¸€æŠ˜ç”¨äºæµ‹è¯•ï¼Œå‰©ä½™ä¸‰æŠ˜ç”¨äºè®­ç»ƒã€‚ç¬¬ä¸€æ¬¡ï¼Œç¬¬ä¸€æŠ˜æ ·æœ¬[0,1,2]ç”¨äºæµ‹è¯•ï¼›ç¬¬äºŒæ¬¡ï¼Œç¬¬äºŒæŠ˜æ ·æœ¬[3,4,5]ç”¨äºæµ‹è¯•ï¼›ç¬¬ä¸‰æ¬¡ï¼Œç¬¬ä¸‰æŠ˜æ ·æœ¬[6,7,8]ç”¨äºæµ‹è¯•ï¼›æœ€åä¸€æ¬¡ï¼Œæœ€åä¸€æŠ˜æ ·æœ¬[9,10,11]ç”¨äºæµ‹è¯•ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œç»è¿‡4æŠ˜äº¤å‰éªŒè¯ï¼Œè®­ç»ƒé›†ä¸­çš„æ‰€æœ‰æ ·æœ¬éƒ½å‚ä¸äº†æ¨¡å‹è®­ç»ƒã€‚\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åœ¨sklearnä¸­è¿›è¡ŒKæŠ˜äº¤å‰éªŒè¯ï¼š\nimport numpy as np from sklearn.model_selection import KFold kf = KFold(4) X = np.arange(12) for train_indices, test_indices in kf.split(X): print(train_indices, test_indices)  ä»¥ä¸Šä»£ç äº§ç”Ÿå¦‚ä¸‹ç»“æœï¼š\n[ 3 4 5 6 7 8 9 10 11] [0 1 2] [ 0 1 2 6 7 8 9 10 11] [3 4 5] [ 0 1 2 3 4 5 9 10 11] [6 7 8] [0 1 2 3 4 5 6 7 8] [ 9 10 11]  å¯ä»¥çœ‹åˆ°ï¼Œè¾“å‡ºç»“æœè·Ÿå›¾ä¸­çš„ä¾‹å­å®Œå…¨ä¸€è‡´ã€‚å¯èƒ½ä½ ä¹Ÿæ³¨æ„åˆ°äº†ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ¯ä¸€æŠ˜éƒ½æ˜¯é¡ºåºäº§ç”Ÿï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥è¿›è¡Œéšæœºé€‰å–ã€‚\n    åŒæ ·åœ°ï¼Œæˆ‘ä»¬çœ‹çœ‹åœ¨sklearnä¸­å¦‚ä½•åšï¼š\nimport numpy as np from sklearn.model_selection import KFold kf = KFold(4, shuffle=True) X = np.arange(12) for train_indices, test_indices in kf.split(X): print(train_indices, test_indices)  ä»¥ä¸Šä»£ç çš„ç»“æœå¦‚ä¸‹ï¼š\n[0 1 2 3 4 6 7 8 9] [ 5 10 11] [ 0 1 2 4 5 6 7 10 11] [3 8 9] [ 0 1 3 4 5 8 9 10 11] [2 6 7] [ 2 3 5 6 7 8 9 10 11] [0 1 4]  å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸€æŠ˜ä¸­çš„æ ·æœ¬ä¸å†è¿ç»­ï¼Œè€Œæ˜¯éšæœºæŠ½å–çš„ã€‚\nå­¦ä¹ æ›²çº¿ åœ¨æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œé€šè¿‡ç»˜åˆ¶è®­ç»ƒè¯¯å·®å’ŒéªŒè¯è¯¯å·® vs. å‚ä¸è®­ç»ƒçš„æ ·æœ¬æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸¤æ¡æ›²çº¿ã€‚\nä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå›¾ï¼š\n   Learning Curves   å›¾çš„å·¦ä¾§æ˜¯ä¸€ä¸ªé«˜åå·®çš„æ¨¡å‹ï¼ˆå¯¹åº”å‰è¿°çš„çº¿æ€§æ¨¡å‹ï¼‰ï¼Œå³æ¨¡å‹æ¬ æ‹Ÿåˆã€‚åœ¨è®­ç»ƒæ ·æœ¬æ¯”è¾ƒå°‘æ—¶ï¼Œæ¨¡å‹èƒ½å¾ˆå¥½åœ°æ‹Ÿåˆæ•°æ®ï¼Œå› æ­¤è®­ç»ƒè¯¯å·®å¾ˆå°ï¼Œä½†å½“è¯„ä¼°æ¨¡å‹æ—¶ï¼Œç”±äºè®­ç»ƒæ ·æœ¬è¾ƒå°‘ï¼Œæ¨¡å‹çš„è¡¨ç°ä¸ä¼šå¤ªå¥½ï¼Œå› æ­¤éªŒè¯è¯¯å·®ä¼šå¾ˆå¤§ã€‚éšç€å‚ä¸è®­ç»ƒçš„æ ·æœ¬å¢åŠ ï¼Œæ›´å¤šçš„æ ·æœ¬éœ€è¦æ‹Ÿåˆï¼Œæ‹Ÿåˆéš¾åº¦å¢åŠ ï¼Œè®­ç»ƒè¯¯å·®å¯èƒ½ä¼šå¢å¤§ä¸€ç‚¹ã€‚æ­¤æ—¶ï¼Œç”±äºä½¿ç”¨äº†æ›´å¤šçš„è®­ç»ƒæ•°æ®ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªç¨å¾®å¥½ç‚¹çš„æ¨¡å‹ï¼Œå› æ­¤éªŒè¯è¯¯å·®ä¼šå‡å°ä¸€ç‚¹ï¼Œä½†ä¸ä¼šå¤ªå¤šã€‚æœ€åï¼Œå½“æ›´å¤šçš„æ•°æ®åŠ å…¥è®­ç»ƒï¼Œè®­ç»ƒè¯¯å·®ä¼šå¢åŠ ä¸€ç‚¹ï¼ŒéªŒè¯è¯¯å·®ä¼šå‡å°ä¸€ç‚¹ï¼Œå®ƒä»¬ä¼šè¶Šæ¥è¶Šé è¿‘ã€‚\nå›¾çš„ä¸­é—´ä¸€ä¸ªåˆšåˆšå¥½çš„æ¨¡å‹ï¼ˆå¯¹åº”äºŒæ¬¡æ›²çº¿æ¨¡å‹ï¼‰ã€‚è·Ÿå‰é¢æè¿°çš„æƒ…å†µä¸€æ ·ï¼Œéšç€å‚ä¸è®­ç»ƒçš„æ ·æœ¬å¢åŠ ï¼Œè®­ç»ƒè¯¯å·®ä¼šå¢åŠ ï¼ŒéªŒè¯è¯¯å·®ä¼šå‡å°ï¼Œæœ€åå®ƒä»¬ä¼šè¶Šæ¥è¶Šæ¥è¿‘ï¼Œä¸åŒäºå·¦ä¾§çš„æƒ…å†µï¼ŒéªŒè¯è¯¯å·®å’Œè®­ç»ƒè¯¯å·®ä¼šæ”¶æ•›åˆ°æ¯”è¾ƒä½çš„ä½ç½®ã€‚\nå›¾çš„å³ä¾§æ˜¯ä¸€ä¸ªé«˜æ–¹å·®çš„æ¨¡å‹ï¼ˆå¯¹åº”é«˜é˜¶æ‹Ÿåˆæ¨¡å‹ï¼‰ï¼Œä¸€å¼€å§‹çš„æƒ…å†µè·Ÿå‰é¢ä¸¤ä¸ªæ¨¡å‹çš„æƒ…å†µä¸€æ ·ï¼Œä½†éšç€å‚ä¸è®­ç»ƒçš„æ ·æœ¬å¢åŠ ï¼Œè®­ç»ƒè¯¯å·®ä¼šå¢åŠ ï¼Œä½†ä¼šæ¯”è¾ƒå°ï¼Œå› ä¸ºæ­¤æ—¶çš„æ¨¡å‹è¯•å›¾å¯¹è®­ç»ƒé›†è¿›è¡Œè®°å¿†ï¼ŒåŒæ—¶éªŒè¯è¯¯å·®ä¼šå‡å°ï¼Œä½†ä¼šæ¯”è¾ƒå¤§ã€‚æœ€åï¼ŒéªŒè¯è¯¯å·®å’Œè®­ç»ƒè¯¯å·®ä¼šæ”¶æ•›ï¼Œä½†ä¸ä¼šé è¿‘ã€‚\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼š\næ ·æœ¬åŒ…å«ä¸¤ç±»æ•°æ®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n   Scatter Plot of data   é’ˆå¯¹è¯¥æ•°æ®ï¼Œæˆ‘ä»¬æ‹Ÿåˆä»¥ä¸‹ä¸‰ä¸ªæ¨¡å‹ï¼Œçœ‹çœ‹å®ƒä»¬çš„å­¦ä¹ æ›²çº¿å¦‚ä½•ï¼š\n é€»è¾‘å›å½’æ¨¡å‹ å†³ç­–æ ‘æ¨¡å‹ æ”¯æŒå‘é‡æœºæ¨¡å‹  import numpy as np import pandas as pd import matplotlib.pyplot as plt from sklearn.model_selection import learning_curve from sklearn.linear_model import LogisticRegression from sklearn.ensemble import GradientBoostingClassifier from sklearn.svm import SVC # Load data df = pd.read_csv('data.csv') X = np.array(df[['x1', 'x2']]) y = np.array(df['y']) # Fix random seed np.random.seed(55) def randomize(X, Y): permutation = np.random.permutation(Y.shape[0]) X2 = X[permutation,:] Y2 = Y[permutation] return X2, Y2 X2, y2 = randomize(X, y) # Construct three models to draw learning curves estimators = {} # Logistic Regression estimators['LR'] = LogisticRegression() # Decision Tree estimators['DT'] = GradientBoostingClassifier() # Support Vector Machine estimators['SVC'] = SVC(kernel='rbf', gamma=1000) plt.figure(figsize=(12, 6)) for i, m in enumerate(estimators): train_sizes, train_scores, test_scores = learning_curve( estimators[m], X2, y2, cv=None, n_jobs=1, train_sizes=np.linspace(.1, 1.0, 10)) train_scores_mean = np.mean(train_scores, axis=1) # train_scores_std = np.std(train_scores, axis=1) test_scores_mean = np.mean(test_scores, axis=1) # test_scores_std = np.std(test_scores, axis=1) plt.subplot(1, 3, i + 1) plt.grid() plt.title(\u0026quot;Learning Curves of {}\u0026quot;.format(m)) plt.xlabel(\u0026quot;Training examples\u0026quot;) plt.ylabel(\u0026quot;Score\u0026quot;) plt.plot(train_scores_mean, 'o-', color=\u0026quot;g\u0026quot;, label=\u0026quot;Training score\u0026quot;) plt.plot(test_scores_mean, 'o-', color=\u0026quot;y\u0026quot;, label=\u0026quot;Cross-validation score\u0026quot;) plt.legend(loc=\u0026quot;best\u0026quot;) plt.tight_layout() plt.show()  ä»¥ä¸Šä»£ç å°†ç”Ÿæˆä¸‰ä¸ªæ¨¡å‹çš„å­¦ä¹ æ›²çº¿ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€çœ‹ï¼š\n   æ ¹æ®è¿™äº›æ›²çº¿å¯ä»¥å¾—å‡ºï¼š\n é€»è¾‘å›å½’æ¨¡å‹çš„è®­ç»ƒå’Œæµ‹è¯•å¾—åˆ†å¾ˆä½ã€‚ å†³ç­–æ ‘æ¨¡å‹çš„è®­ç»ƒå’Œæµ‹è¯•å¾—åˆ†å¾ˆé«˜ã€‚ æ”¯æŒå‘é‡æœºæ¨¡å‹çš„è®­ç»ƒå¾—åˆ†å¾ˆé«˜ï¼Œæµ‹è¯•å¾—åˆ†å¾ˆä½  å› æ­¤ï¼Œå†³ç­–æ ‘æ¨¡å‹åˆšåˆšå¥½ï¼Œé€»è¾‘å›å½’æ¨¡å‹æ¬ æ‹Ÿåˆï¼Œè€Œæ”¯æŒå‘é‡æœºæ¨¡å‹è¿‡æ‹Ÿåˆã€‚\nåŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥åè½¬è¿™äº›æ›²çº¿ï¼ˆå› ä¸ºåº¦é‡ä½¿ç”¨çš„æ˜¯å¾—åˆ†è€Œä¸æ˜¯è¯¯å·®ï¼‰ç„¶åä¸ä¸‹å›¾è¿›è¡Œå¯¹æ¯”ã€‚\n   æœ€åï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹åœ¨å®é™…æƒ…å†µä¸­æ˜¯å¦ä¹Ÿè¿™æ ·ï¼Œä¸ºæ­¤æˆ‘ä»¬ç»˜åˆ¶æ¨¡å‹çš„è¾¹ç•Œæ›²çº¿ï¼š\n   æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š\n é€»è¾‘å›å½’æ¨¡å‹ä½¿ç”¨ä¸€æ¡ç›´çº¿ï¼Œè¿™å¤ªç®€å•äº†ã€‚åœ¨è®­ç»ƒé›†ä¸Šçš„æ•ˆæœä¸å¤ªå¥½ï¼Œå› æ­¤æ¬ æ‹Ÿåˆã€‚ å†³ç­–æ ‘æ¨¡å‹ä½¿ç”¨ä¸€ä¸ªæ–¹å½¢ï¼Œæ‹Ÿåˆçš„å¾ˆå¥½ï¼Œå¹¶èƒ½å¤Ÿæ³›åŒ–ã€‚å› æ­¤ï¼Œè¯¥æ¨¡å‹æ•ˆæœå¾ˆå¥½ã€‚ æ”¯æŒå‘é‡æœºæ¨¡å‹å®é™…ä¸Šåœ¨æ¯ä¸ªç‚¹å‘¨å›´éƒ½ç”»äº†ä¸€ä¸ªå°åœ†åœˆã€‚å®ƒå®é™…ä¸Šæ˜¯åœ¨è®°ä½è®­ç»ƒé›†ï¼Œæ— æ³•æ³›åŒ–ã€‚å› æ­¤ï¼Œè¿‡æ‹Ÿåˆã€‚    è¿™é‡Œçš„æµ‹è¯•å®ä¸ºéªŒè¯ï¼Œä¸åŒäºæœ€ç»ˆçš„æµ‹è¯•ï¼Œåè€…æŒ‡æ¨¡å‹è¯„ä¼°ï¼Œå‰è€…ä¸ºæ¨¡å‹éªŒè¯ã€‚ \u0026#x21a9;\u0026#xfe0e;\n   ","date":1584098046,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1584098046,"objectID":"389262a3389827e74e796204507c9f54","permalink":"https://keris.github.io/zh/post/model-selection/","publishdate":"2020-03-13T19:14:06+08:00","relpermalink":"/zh/post/model-selection/","section":"post","summary":"å¦‚ä½•é€‰æ‹©ä¸€ä¸ªå¥½çš„æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œæ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆåˆ¤æ–­","tags":["æ¬ æ‹Ÿåˆ","è¿‡æ‹Ÿåˆ","äº¤å‰éªŒè¯"],"title":"æœºå™¨å­¦ä¹ æ¨¡å‹é€‰æ‹©","type":"post"},{"authors":[],"categories":["æœºå™¨å­¦ä¹ "],"content":"ç›®å½•  æ··æ·†çŸ©é˜µ Accuracy Precision Recall F1 score $F_\\beta$ score ROC Curve AUC å›å½’æŒ‡æ ‡   æ··æ·†çŸ©é˜µ     guessed positive guessed negative     positive true positives, #TP false negatives, #FN   negative false positives, #FP true negatives, #TN    å‡è®¾æŸä¸ªæ¨¡å‹åœ¨ä¸€ç»„æ ·æœ¬ä¸Šçš„è¡¨ç°å¦‚ä¸‹ï¼š\n   å…¶ä¸­ï¼Œè“è‰²çš„ç‚¹ä¸ºæ­£ä¾‹ï¼ˆpositives)ï¼Œæ©™è‰²çš„ç‚¹ä¸ºè´Ÿä¾‹ï¼ˆnegativesï¼‰ï¼Œåˆ™æ··æ·†çŸ©é˜µå¦‚ä¸‹ï¼š\n    guessed positive guessed negative     positive 6 1   negative 2 5    Accuracy Accuracyï¼Œä¹Ÿå°±æ˜¯å‡†ç¡®ç‡ï¼Œè¡¨ç¤ºæ ·æœ¬ä¸­åˆ†ç±»æ­£ç¡®æ‰€å çš„æ¯”ä¾‹ã€‚\n$$\\text{Accuracy} = \\frac{\\text{#TP} + \\text{#TN}}{\\text{#TP} + \\text{#FP} + \\text{#TN} + \\text{#FN}}$$\nå…¶ä¸­:\n #TPè¡¨ç¤ºtrue positiveçš„æ•°ç›® #FPè¡¨ç¤ºfalse positiveçš„æ•°ç›® #TNè¡¨ç¤ºtrue negativeçš„æ•°ç›® #FNè¡¨ç¤ºfalse negativeçš„æ•°ç›®  å¯¹äºå›¾1ä¸­çš„æ¨¡å‹ï¼Œå‡†ç¡®ç‡è®¡ç®—å¦‚ä¸‹ï¼š\n$$\\text{Accuracy} = \\frac{6 + 5}{6 + 1 + 5 + 2} = \\frac{11}{14}= 78.57\\%$$\nå‡†ç¡®ç‡åœ¨æ•°æ®åæ–œçš„æƒ…å†µä¸‹å°†ä¸å†é€‚ç”¨ã€‚æ¯”å¦‚åœ¨ä¸‹å›¾æ‰€ç¤ºçš„ä¾‹å­ä¸­ï¼š\n   æ¨¡å‹éœ€è¦æ‰¾å‡ºè‰¯å¥½çš„äº¤æ˜“ï¼Œä½†æˆ‘ä»¬çš„æ ·æœ¬ä¸­ç»å¤§éƒ¨åˆ†éƒ½æ˜¯è‰¯å¥½çš„äº¤æ˜“ï¼Œè¿™å¯¼è‡´æ— è®ºæˆ‘ä»¬çš„æ¨¡å‹å¦‚ä½•ï¼Œå®ƒéƒ½å…·æœ‰å¾ˆé«˜çš„å‡†ç¡®ç‡ï¼Œå¦‚å›¾ä¸­æ‰€ç¤ºä¸º99.83%ï¼ï¼Œæ­¤æ—¶å‡†ç¡®ç‡å°†ä¸èƒ½å¤Ÿè¯„ä¼°æˆ‘ä»¬çš„æ¨¡å‹ã€‚\nPrecision Precisionå³ç²¾åº¦ï¼Œè¡¨ç¤ºåœ¨æ‰€æœ‰é¢„æµ‹ä¸ºæ­£ä¾‹çš„æ ·æœ¬ä¸­æœ‰å¤šå°‘æ˜¯çœŸæ­£ä¾‹ã€‚\n$$\\text{Precision} = \\frac{\\text{#TP}}{\\text{#TP} + \\text{#FP}}$$\nå¯¹äºå›¾1ä¸­çš„æ¨¡å‹ï¼Œç²¾åº¦è®¡ç®—å¦‚ä¸‹ï¼š\n$$\\text{Precision} = \\frac{6}{6 + 2} = \\frac{6}{8} = 75\\%$$\nRecall Recallå³ä¸ºå¬å›ç‡ï¼Œæ‰€æœ‰çš„æ­£ä¾‹æ ·æœ¬ä¸­çœŸæ­£ä¾‹æ‰€å çš„æ¯”ä¾‹ï¼š\n$$\\text{Recall} = \\frac{\\text{#TP}}{\\text{#TP} + \\text{#FN}}$$\nå¯¹äºå›¾1ä¸­çš„æ¨¡å‹ï¼Œå¬å›ç‡è®¡ç®—å¦‚ä¸‹ï¼š\n$$\\text{Recall} = \\frac{6}{6 + 1} = \\frac{6}{7} = 85.71\\%$$\nF1 score F1-scoreå®šä¹‰å¦‚ä¸‹ï¼š\n$$\\text{F1} = 2 \\times \\frac{\\text{Precision} \\times \\text{Recall}}{\\text{Precision} + \\text{Recall}}$$\nå¯ä»¥çœ‹åˆ°F1-scoreç»¼åˆäº†ç²¾åº¦å’Œå¬å›ç‡ï¼Œä¸ºç²¾åº¦å’Œå¬å›ç‡çš„è°ƒå’Œå¹³å‡ï¼šåœ¨å¬å›ç‡ä¸å˜çš„æ¡ä»¶ä¸‹ï¼Œç²¾åº¦è¶Šé«˜ï¼ŒF1-scoreè¶Šå¤§ï¼›åœ¨ç²¾åº¦ä¸å˜çš„æ¡ä»¶ä¸‹ï¼Œå¬å›ç‡è¶Šé«˜ï¼ŒF1-scoreè¶Šå¤§ã€‚\n$F_\\beta$ score $F_\\beta-\\text{score}$å®šä¹‰ä¸ºï¼š\n$$F_\\beta = (1 + \\beta^2) \\times \\frac{\\text{Precision} \\times \\text{Recall}}{\\beta^2 \\times \\text{Precision} + \\text{Recall}}$$\nå¯ä»¥çœ‹å‡ºæ¥ï¼Œå½“$\\beta = 1$æ—¶å³ä¸ºF1 scoreã€‚\nä¸‹é¢æˆ‘ä»¬çœ‹ä¸‹$F_\\beta$éš$\\beta$å˜åŒ–çš„æƒ…å†µï¼š\n å½“$\\beta = 0$æ—¶ï¼Œé€šè¿‡è®¡ç®—ä¸éš¾å¾—å‡º$F_0 = \\text{Precision}$; ç›¸åï¼Œå½“$\\beta$å–å¾ˆå¤§çš„å€¼æ—¶ï¼Œ$F_\\beta$å°†è¶‹è¿‘å¬å›ç‡ã€‚  å°ç»“ï¼šå½“$\\beta$å–è¾ƒå°çš„å€¼æ—¶ï¼Œç²¾åº¦æ¯”å¬å›ç‡é‡è¦ï¼Œå¦‚$F_{0.5}$ scoreï¼›å½“$\\beta$å–è¾ƒå¤§å€¼æ—¶å¬å›ç‡æ¯”ç²¾åº¦é‡è¦ï¼Œå¦‚$F_2$ scoreã€‚\nROC Curve ROC Curveçš„å…¨ç§°ä¸ºReceiver Operating Characteristic Curveï¼Œå³å—è¯•è€…å·¥ä½œç‰¹æ€§ç¼ºé™·ï¼Œå®ƒåˆ»ç”»äº†æ¨¡å‹åœ¨æ‰€æœ‰åˆ†ç±»é˜ˆå€¼ä¸‹çš„è¡¨ç°ã€‚\nè¦ç»˜åˆ¶è¯¥æ›²çº¿ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—ä»¥ä¸‹ä¸¤ä¸ªå‚æ•°ï¼š\n True Positive Rate, TPR False Positive Rate, FPR  TPRï¼Œè¡¨ç¤ºæ‰€æœ‰çš„æ­£ä¾‹æ ·æœ¬ä¸­çœŸæ­£ä¾‹çš„å æ¯”ï¼Œä¸éš¾å‘ç°ï¼Œè¿™å…¶å®è·Ÿå¬å›ç‡ä¸€ä¸ªæ¦‚å¿µï¼š\n$$\\text{TPR} = \\frac{\\text{#TP}}{\\text{#TP} + \\text{#FN}}$$\nFPRï¼Œè¡¨ç¤ºæ‰€æœ‰çš„è´Ÿä¾‹æ ·æœ¬ä¸­å‡æ­£ä¾‹çš„å æ¯”ï¼š\n$$\\text{FPR} = \\frac{\\text{#FP}}{\\text{#FP} + \\text{#TN}}$$\nåœ¨ä¸åŒçš„åˆ†ç±»é˜ˆå€¼ä¸‹ç»˜åˆ¶TPR vs. FPRä¾¿å¾—åˆ°ROCæ›²çº¿ï¼š\n   AUC AUCçš„å…¨ç§°ä¸ºArea Under a ROC Curveï¼Œå³ROCæ›²çº¿ä¸‹çš„é¢ç§¯ã€‚\n   å›å½’æŒ‡æ ‡  Mean Absolute Error (MAE)  MAEå³å¹³å‡ç»å¯¹è¯¯å·®ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ç»„æ ·æœ¬${x_i, y_i}, i = 1, 2, \\cdots, n$ï¼Œæ¨¡å‹çš„è¾“å‡ºä¸º$\\text{preds} = [\\hat{y}_1, \\hat{y}_2, \\cdots, \\hat{y}_n]$ï¼Œåˆ™MAEè®¡ç®—å¦‚ä¸‹ï¼š\n$$\\text{MAE} = \\frac{1}{n}\\sum_i^n |y_i - \\hat{y}_i|$$\nå€ŸåŠ©sklearnï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è®¡ç®—MAEï¼š\nfrom sklearn.metrics import mean_absolute_error from sklearn.linear_model import LinearRegression clf = LinearRegression() preds = clf.fit(X, y) error = mean_absolute_error(y, preds)  ä»å…¬å¼æ¥çœ‹ï¼ŒMAEä¸å¯å¯¼ï¼Œä½¿å¾—ä¸èƒ½é‡‡ç”¨æ¢¯åº¦ä¸‹é™æ–¹æ³•è¿›è¡Œä¼˜åŒ–ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥å€ŸåŠ©å‡æ–¹è¯¯å·®ã€‚\nMean Squared Error (MSE)  MSEå³å‡æ–¹è¯¯å·®ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š\n$$\\text{MSE} = \\frac{1}{n}\\sum_i^n (y_i - \\hat{y}_i)^2$$\nåŒæ ·åœ°ï¼ŒMSEé€šè¿‡sklearnå¯ä»¥å¾ˆæ–¹ä¾¿åœ°è¿›è¡Œè®¡ç®—ï¼š\nfrom sklearn.metrics import mean_squared_error from sklearn.linear_model import LinearRegression clf = LinearRegression() preds = clf.fit(X, y) error = mean_squared_error(y, preds)  R2 Score  R2åˆ†æ•°é€šè¿‡å°†ç°æœ‰çš„æ¨¡å‹ä¸æœ€ç®€å•çš„å¯èƒ½æ¨¡å‹ç›¸æ¯”å¾—å‡ºã€‚\næ¯”å¦‚ï¼Œæˆ‘ä»¬è¦æ‹Ÿåˆä¸€å †æ•°æ®ç‚¹ï¼Œé‚£æœ€ç®€å•çš„å¯èƒ½æ¨¡å‹æ˜¯ä»€ä¹ˆï¼Ÿé‚£å°±æ˜¯æˆ‘ä»¬å–æ‰€æœ‰å€¼çš„å¹³å‡å€¼ï¼Œç„¶åç”»ä¸€æ¡æ°´å¹³çº¿ã€‚æ­¤æ—¶æˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºè¿™ä¸ªæ¨¡å‹çš„å‡æ–¹è¯¯å·®å¤§äºçº¿æ€§å›å½’æ¨¡å‹çš„å‡æ–¹è¯¯å·®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n   R2åˆ†æ•°å®šä¹‰ä¸ºï¼š\n$$\\text{R2} = 1 - \\frac{\\text{MSE of å½“å‰æ¨¡å‹}}{\\text{MSE of æœ€ç®€å•çš„å¯èƒ½æ¨¡å‹}}$$\nä»¥ä¸Šå›¾ä¸ºä¾‹ï¼Œåˆ†å­ä¸ºçº¿æ€§å›å½’æ¨¡å‹ï¼ˆå³ä¾§ï¼‰çš„å‡æ–¹è¯¯å·®ï¼Œåˆ†æ¯ä¸ºç®€å•æ¨¡å‹ï¼ˆå·¦ä¾§ï¼‰çš„å‡æ–¹è¯¯å·®ã€‚\nç”±äºæœ€ç®€å•çš„å¯èƒ½æ¨¡å‹çš„å‡æ–¹è¯¯å·®å¤§äºçº¿æ€§å›å½’æ¨¡å‹çš„å‡æ–¹è¯¯å·®ï¼Œæˆ‘ä»¬åœ¨ç›¸æ¯”ä¹‹åå¾—åˆ°ä¸€ä¸ª0åˆ°1ä¹‹é—´çš„æ•°å­—ï¼Œä»è€ŒR2å¾—åˆ†ä¹Ÿæ˜¯ä¸€ä¸ª0åˆ°1ä¹‹é—´çš„æ•°ï¼Œå¹¶ä¸”æœ‰ä»¥ä¸‹ç»“è®ºï¼š\n R2è¶Šæ¥è¿‘0ï¼Œæˆ‘ä»¬çš„æ¨¡å‹è¶Šæ¥è¿‘æœ€ç®€å•çš„å¯èƒ½æ¨¡å‹ï¼Œæ­¤æ—¶æ¨¡å‹æ˜¯ä¸€ä¸ªbad model ç›¸åï¼ŒR2è¶Šæ¥è¿‘1ï¼Œè¯´æ˜æˆ‘ä»¬æ¨¡å‹ç›¸æ¯”æœ€ç®€å•çš„å¯èƒ½æ¨¡å‹å…·æœ‰æ›´å°çš„å‡æ–¹è¯¯å·®ï¼Œæ­¤æ—¶æ¨¡å‹æ˜¯ä¸€ä¸ªgood model  åœ¨sklearnä¸­ï¼Œæˆ‘ä»¬å¦‚ä¸‹è®¡ç®—R2å¾—åˆ†ï¼š\n\u0026gt;\u0026gt;\u0026gt; from sklearn.metrics import r2_score \u0026gt;\u0026gt;\u0026gt; y_true = [1, 2, 4] \u0026gt;\u0026gt;\u0026gt; y_pred = [1.3, 2.5, 3.7] \u0026gt;\u0026gt;\u0026gt; r2_score(y_true, y_pred) \u0026gt;\u0026gt;\u0026gt; 0.9078571428571429  ","date":1583925611,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1583925611,"objectID":"9b5a8c97e2b1a3c38fd669a38e165a5e","permalink":"https://keris.github.io/zh/post/metrics/","publishdate":"2020-03-11T19:20:11+08:00","relpermalink":"/zh/post/metrics/","section":"post","summary":"äº†è§£æœºå™¨å­¦ä¹ æ¨¡å‹çš„å„ç§è¯„ä¼°æŒ‡æ ‡","tags":["è¯„ä¼°æŒ‡æ ‡"],"title":"è¯„ä¼°æŒ‡æ ‡","type":"post"},{"authors":[],"categories":["é‡‘èé£æ§"],"content":"ç›®å½•  ä¿¡ç”¨è¯„åˆ†å¡æ¨¡å‹  è¯„åˆ†å¡æ¨¡å‹åˆ’åˆ† å¦‚ä½•åˆ©ç”¨è¯„åˆ†å¡å¯¹ç”¨æˆ·è¿›è¡Œè¯„åˆ†ï¼Ÿ å°ç»“   è¯„åˆ†å¡æ¨¡å‹çš„å¼€å‘  è¯„åˆ†å¡æ¨¡å‹å¼€å‘æµç¨‹  æ•°æ®è·å– EDA æ•°æ®é¢„å¤„ç† æ•°æ®æ¸…æ´— å˜é‡åˆ†ç®±  æ— ç›‘ç£åˆ†ç®± æœ‰ç›‘ç£åˆ†ç®± å°ç»“         ä¿¡ç”¨è¯„åˆ†å¡æ¨¡å‹ ä¿¡ç”¨è¯„åˆ†å¡æ¨¡å‹æ˜¯ä¸€ç§æœ€å¸¸è§çš„é‡‘èé£æ§æ‰‹æ®µã€‚å®ƒæ˜¯æŒ‡æ ¹æ®å®¢æˆ·çš„å„ç§å±æ€§å’Œè¡Œä¸ºæ•°æ®æ„å»ºä¸€ä¸ªä¿¡ç”¨è¯„åˆ†æ¨¡å‹ï¼Œå¯¹å®¢æˆ·è¿›è¡Œä¿¡ç”¨è¯„åˆ†ï¼Œå¹¶æ®æ­¤å†³å®šæ˜¯å¦ç»™äºˆæˆä¿¡ä»¥åŠæˆä¿¡çš„é¢åº¦å’Œåˆ©ç‡ï¼Œä»è€Œè¯†åˆ«å’Œå‡å°‘åœ¨é‡‘èäº¤æ˜“ä¸­å­˜åœ¨çš„äº¤æ˜“é£é™©ã€‚\nä»¥ä¸‹ä¸ºè¯„åˆ†å¡æ¨¡å‹çš„ç¤ºæ„å›¾ï¼š\n  Credit Score Card Demo   è¯„åˆ†å¡æ¨¡å‹åˆ’åˆ† åœ¨ä¸åŒçš„ä¸šåŠ¡é˜¶æ®µæˆ‘ä»¬å¯ä»¥æ„å»ºä¸åŒçš„è¯„åˆ†å¡æ¨¡å‹ã€‚æ ¹æ®å€Ÿè´·æ—¶é—´ï¼Œè¯„åˆ†å¡æ¨¡å‹å¯ä»¥åˆ’åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§ï¼š\n è´·å‰ï¼šç”³è¯·è¯„åˆ†å¡ï¼ˆApplication score cardï¼‰ï¼Œåˆç§°ä¸ºAå¡ è´·ä¸­ï¼šè¡Œä¸ºè¯„åˆ†å¡ï¼ˆBehavior score cardï¼‰ï¼Œåˆç§°ä¸ºBå¡ è´·åï¼šå‚¬æ”¶è¯„åˆ†å¡ï¼ˆCollection score cardï¼‰ï¼Œåˆç§°ä¸ºCå¡  å¦‚ä½•åˆ©ç”¨è¯„åˆ†å¡å¯¹ç”¨æˆ·è¿›è¡Œè¯„åˆ†ï¼Ÿ ä¸€ä¸ªç”¨æˆ·çš„è¯„åˆ†ç­‰äºåŸºå‡†åˆ†åŠ ä¸Šå¯¹å®¢æˆ·å„ä¸ªå±æ€§çš„è¯„åˆ†ã€‚å¯¹å‰é¢ç»™å‡ºçš„ç¤ºæ„å›¾ä¸­çš„ä¾‹å­è€Œè¨€ï¼š\nå®¢æˆ·è¯„åˆ† = åŸºå‡†åˆ† + å¹´é¾„è¯„åˆ† + æ€§åˆ«è¯„åˆ† + å©šå§»çŠ¶å†µè¯„åˆ† + å­¦å†è¯„åˆ† + æœˆæ”¶å…¥è¯„åˆ†  ç°æœ‰ä¸€å®¢æˆ·ï¼Œå…¶å¹´é¾„ä¸º27å²ï¼Œæ€§åˆ«ç”·ï¼Œå·²å©šï¼Œæœ¬ç§‘å­¦å†ï¼Œæœˆæ”¶å…¥ä¸º10kï¼Œé‚£ä¹ˆä»–çš„è¯„åˆ†ä¸ºï¼š\n223(åŸºå‡†åˆ†) + 8(å¹´é¾„è¯„åˆ†) + 4(æ€§åˆ«è¯„åˆ†) + 8(å©šå§»çŠ¶å†µè¯„åˆ†) + 8(å­¦å†è¯„åˆ†) + 13(æœˆæ”¶å…¥è¯„åˆ†) = 264  å°ç»“ ä»¥ä¸Šå°±æ˜¯è¯„åˆ†å¡æ¨¡å‹çš„å…·ä½“ç”¨æ³•ã€‚åœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼Œä¸éš¾å‘ç°ä»¥ä¸‹ä¸‰ä¸ªé—®é¢˜ï¼š\n å¦‚ä½•é€‰æ‹©ç”¨æˆ·çš„å±æ€§ï¼Ÿ è¯„åˆ†å¡æ¨¡å‹é‡‡ç”¨çš„æ˜¯å¯¹å±æ€§çš„åˆ†æ®µè¿›è¡Œè¯„åˆ†ï¼Œé‚£ä¹ˆå¦‚ä½•è¿›è¡Œæœ‰æ•ˆçš„åˆ†æ®µï¼Ÿ å¦‚ä½•å¯¹æ¯ä¸ªåˆ†æ®µè¿›è¡Œè¯„åˆ†ï¼Ÿ  è¯„åˆ†å¡æ¨¡å‹çš„å¼€å‘ è¯„åˆ†å¡æ¨¡å‹å¼€å‘æµç¨‹ ä¿¡ç”¨è¯„åˆ†å¡æ¨¡å‹çš„å¼€å‘ä¸€èˆ¬åŒ…æ‹¬æ•°æ®è·å–ï¼ŒEDAï¼Œæ•°æ®é¢„å¤„ç†ï¼Œå˜é‡ç­›é€‰ï¼Œæ¨¡å‹å¼€å‘åŠè¯„ä¼°ï¼Œç”Ÿæˆè¯„åˆ†å¡æ¨¡å‹ï¼Œæ¨¡å‹ä¸Šçº¿åŠç›‘æµ‹ã€‚å…¸å‹çš„å¼€å‘æµç¨‹å›¾å¦‚ä¸‹ï¼š\n  Credit Score Card Flowchart   æ•°æ®è·å– æ•°æ®ä¸»è¦æœ‰ä¸¤ä¸ªæ¥æºï¼š\n é‡‘èæœºæ„è‡ªæœ‰æ•°æ®ï¼šå¦‚ç”¨æˆ·çš„å¹´é¾„ï¼Œæˆ·ç±ï¼Œæ€§åˆ«ï¼Œæ”¶å…¥ï¼Œè´Ÿå€ºæ¯”ï¼Œåœ¨æœ¬æœºæ„çš„å€Ÿæ¬¾å’Œè¿˜æ¬¾è¡Œä¸ºç­‰ ç¬¬ä¸‰æ–¹æ•°æ®ï¼šå¦‚ç”¨æˆ·åœ¨å…¶ä»–æœºæ„çš„å€Ÿè´·è¡Œä¸ºï¼Œç”¨æˆ·çš„æ¶ˆè´¹è¡Œä¸ºæ•°æ®ç­‰  EDA EDAä¸ºExploratory Data Analysisçš„ç®€å†™ï¼Œå³æ¢ç´¢æ€§æ•°æ®åˆ†æã€‚è¿™ä¸ªé˜¶æ®µæ—¨åœ¨äº†è§£æ•°æ®çš„ä¸»è¦ç‰¹æ€§ï¼Œå¦‚å­—æ®µçš„ç¼ºå¤±æƒ…å†µï¼Œå¼‚å¸¸å€¼æƒ…å†µï¼Œä¸­ä½æ•°ï¼Œåˆ†å¸ƒç­‰ã€‚æœ€ååˆ¶å®šä¸€ä¸ªåˆç†çš„æ•°æ®é¢„å¤„ç†æ–¹æ¡ˆã€‚\næ•°æ®é¢„å¤„ç† æ•°æ®é¢„å¤„ç†ä¸»è¦åŒ…æ‹¬æ•°æ®æ¸…æ´—ï¼Œå˜é‡åˆ†ç®±å’ŒWOEç¼–ç ã€‚\næ•°æ®æ¸…æ´— æ•°æ®æ¸…æ´—ä¸»è¦æ˜¯å¯¹æ•°æ®ä¸­çš„ç¼ºå¤±å€¼å’Œå¼‚å¸¸å€¼è¿›è¡Œå¤„ç†ã€‚ä¸€èˆ¬æˆ‘ä»¬é€‰æ‹©åˆ é™¤ç¼ºå¤±ç‡è¶…è¿‡æŸä¸ªé˜ˆå€¼1ï¼ˆå¦‚30%ï¼Œ50%ç­‰ï¼‰çš„å˜é‡ã€‚\nå˜é‡åˆ†ç®± æ‰€è°“çš„åˆ†ç®±å®šä¹‰å¦‚ä¸‹ï¼š\n å¯¹è¿ç»­å˜é‡è¿›è¡Œåˆ†æ®µä»¥ç¦»æ•£åŒ– å°†ç¦»æ•£å˜é‡çš„å¤šä¸ªçŠ¶æ€è¿›è¡Œåˆå¹¶ï¼Œå‡å°‘ç¦»æ•£å˜é‡çš„çŠ¶æ€æ•°  é€šè¿‡åˆ†ç®±æ“ä½œï¼Œæˆ‘ä»¬è¾¾åˆ°äº†å¯¹å˜é‡åˆ†æ®µçš„ç›®çš„ã€‚\nå¸¸è§çš„åˆ†ç®±ç±»å‹å¦‚ä¸‹ï¼š\n  å¸¸è§çš„å˜é‡åˆ†ç®±ç±»å‹   æ— ç›‘ç£åˆ†ç®± æ— ç›‘ç£åˆ†ç®±ä¸»è¦åŒ…æ‹¬ä¸‰ç±»ï¼š\n ç­‰é¢‘åˆ†ç®±ï¼šæŠŠè‡ªå˜é‡çš„å€¼æŒ‰ä»å°åˆ°å¤§æ’åºï¼Œå°†è‡ªå˜é‡çš„å–å€¼ä¸ªæ•°ç­‰åˆ†ä¸ºkéƒ¨åˆ†ï¼Œæ¯éƒ¨åˆ†ä½œä¸ºä¸€ä¸ªåˆ†ç®± ç­‰è·åˆ†ç®±ï¼šæŠŠè‡ªå˜é‡çš„å€¼æŒ‰ä»å°åˆ°å¤§æ’åºï¼Œå°†è‡ªå˜é‡çš„å–å€¼èŒƒå›´åˆ†ä¸ºkä¸ªç­‰è·çš„åŒºé—´ï¼Œæ¯ä¸ªåŒºé—´ä½œä¸ºä¸€ä¸ªåˆ†ç®± èšç±»åˆ†ç®±ï¼šç”¨k-meansç­‰èšç±»æ³•å°†è‡ªå˜é‡åˆ†ä¸ºkç±»ï¼Œä½†éœ€è¦åœ¨èšç±»è¿‡ç¨‹ä¸­ä¿è¯åˆ†ç®±çš„æœ‰åºæ€§  å°ç»“ï¼š æ— ç›‘ç£åˆ†ç®±ä»…è€ƒè™‘äº†å„ä¸ªå˜é‡è‡ªèº«çš„ç»“æ„ï¼Œå¹¶æ²¡æœ‰è€ƒè™‘è‡ªå˜é‡ä¸ç›®æ ‡å˜é‡ä¹‹é—´çš„å…³ç³»ï¼Œå› æ­¤è¿™ç§åˆ†ç®±æ–¹æ³•ä¸ä¸€å®šä¼šå¸¦æ¥æ¨¡å‹æ€§èƒ½çš„æå‡ã€‚\næœ‰ç›‘ç£åˆ†ç®± æœ‰ç›‘ç£åˆ†ç®±ä¸»è¦åŒ…æ‹¬Splitåˆ†ç®±å’ŒMergeåˆ†ç®±ã€‚\n Splitåˆ†ç®±æ˜¯ä¸€ç§è‡ªä¸Šè€Œä¸‹çš„åˆ†ç®±æ–¹æ³•ï¼Œå…¶å’Œå†³ç­–æ ‘æ¯”è¾ƒç›¸ä¼¼ï¼Œåˆ‡åˆ†ç‚¹çš„é€‰æ‹©æŒ‡æ ‡ä¸»è¦æœ‰entropyï¼Œ giniæŒ‡æ•°å’ŒIVå€¼ç­‰ã€‚ Mergeåˆ†ç®±æ˜¯ä¸€ç§è‡ªä¸‹è€Œä¸Šçš„åˆ†ç®±æ–¹æ³•ï¼Œå¸¸è§çš„mergeåˆ†ç®±ä¸ºChiMergeåˆ†ç®±ã€‚  ChiMergeåˆ†ç®±çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šå¦‚æœä¸¤ä¸ªç›¸é‚»åŒºé—´å…·æœ‰ç›¸ä¼¼çš„ç±»åˆ†å¸ƒï¼Œåˆ™åˆå¹¶å®ƒä»¬ï¼Œå¦åˆ™ä¿æŒä¸å˜ã€‚ChiMergeé€šå¸¸é‡‡ç”¨å¡æ–¹å€¼æ¥åº¦é‡ä¸¤ç›¸é‚»åŒºé—´çš„ç±»åˆ†å¸ƒçš„ç›¸ä¼¼æ€§ã€‚\nè®¡ç®—å¡æ–¹å€¼çš„å…¬å¼å¦‚ä¸‹ï¼š\n$$ \\chi^2 = \\sum_{i=1}^2 \\sum_{j=1}^k \\frac{(A_{ij} - E_{ij})^2}{E_{ij}} $$\nå…¶ä¸­ï¼š\n$k =$ ç±»åˆ«æ•°ç›®\n$A_{ij} =$ ç¬¬ $i$ ä¸ªåŒºé—´ä¸­ç¬¬$j$ä¸ªç±»åˆ«çš„æ ·æœ¬æ•°ç›®\n$E_{ij} = A_{ij}$çš„æœŸæœ›é¢‘ç‡$=\\frac{R_i \\times C_j}{N}$ï¼Œ$R_i =$ç¬¬$i$åŒºé—´çš„æ ·æœ¬æ•°ç›®$= \\sum_{j=1}^k A_{ij}$ï¼Œ$C_j = $ç¬¬$j$ä¸ªç±»åˆ«çš„æ ·æœ¬æ•°ç›®$= \\sum_{i=1}^2 A_{ij}$\nChiMergeç®—æ³•åŒ…å«ä¸€ä¸ªåˆå§‹åŒ–æ­¥å’Œä¸€ä¸ªè‡ªåº•å‘ä¸Šçš„åˆå¹¶è¿‡ç¨‹ã€‚\n åˆå§‹åŒ–ï¼šå°†éœ€è¦ç¦»æ•£åŒ–çš„å±æ€§çš„å€¼æŒ‰ä»å°åˆ°å¤§æ’åºï¼Œå°†æ¯ä¸ªæ ·æœ¬ä½œä¸ºä¸€ä¸ªåŒºé—´ åˆå¹¶åŒºé—´  è®¡ç®—æ¯å¯¹ç›¸é‚»åŒºé—´çš„$\\chi^2$ åˆå¹¶å…·æœ‰æœ€å°$\\chi^2$çš„ç›¸é‚»åŒºé—´   å¦‚æœæ‰€æœ‰ç›¸é‚»åŒºé—´å¯¹çš„$\\chi^2$è¶…è¿‡äº†$\\chi^2-threshold$ï¼Œåˆ™åœæ­¢ï¼Œå¦åˆ™å›åˆ°ç¬¬2æ­¥  å¦‚ä½•ç¡®å®š$\\chi^2-threshold$ï¼Ÿä¸ºæ­¤æˆ‘ä»¬éœ€è¦é€‰æ‹©ä¸€ä¸ªæƒ³è¦çš„æ˜¾è‘—æ€§æ°´å¹³å’Œè‡ªæœ‰åº¦ï¼Œç„¶åé€šè¿‡æŸ¥è¡¨æˆ–è€…å…¬å¼è·å¾—å¯¹åº”çš„$\\chi^2$ã€‚å…¶ä¸­è‡ªç”±åº¦ä¸ºç±»åˆ«æ•°ç›® - 1ï¼Œä¾‹å¦‚ï¼Œå½“æœ‰3ä¸ªç±»åˆ«æ—¶ï¼Œè‡ªç”±åº¦ä¸º2ã€‚\né™¤äº†ä½¿ç”¨$\\chi^2-threshold$ï¼Œè¿˜å¯ä»¥æŒ‡å®šæœ€å°åŒºé—´æ•°å’Œæœ€å¤§åŒºé—´æ•°æ¥ç¡®ä¿ä¸ä¼šäº§ç”Ÿå¤ªå°‘æˆ–è€…å¤ªå¤šçš„åŒºé—´ã€‚\nåœ¨é‡‘èé£æ§ä¸­ï¼Œå½“æˆ‘ä»¬åº”ç”¨ChiMergeæ—¶ï¼Œåœ¨åˆå§‹åŒ–æ—¶å¾€å¾€æœ‰ä»¥ä¸‹æ“ä½œï¼š\n è¿ç»­å€¼æŒ‰å‡åºæ’åˆ—ï¼Œç¦»æ•£å€¼é¦–å…ˆè½¬åŒ–ä¸ºåå®¢æˆ·çš„å æ¯”ï¼Œç„¶åå†æŒ‰å‡åºæ’åˆ— ä¸ºäº†å‡å°‘è®¡ç®—é‡ï¼Œå¯¹äºçŠ¶æ€æ•°å¤§äºæŸä¸€é˜ˆå€¼ï¼ˆå»ºè®®ä¸º100ï¼‰çš„å˜é‡ï¼Œåˆ©ç”¨ç­‰é¢‘åˆ†ç®±è¿›è¡Œç²—åˆ†ç®± è‹¥æœ‰ç¼ºå¤±å€¼ï¼Œåˆ™ç¼ºå¤±å€¼å•ç‹¬ä½œä¸ºä¸€ä¸ªåˆ†ç®±  åœ¨åˆ†ç®±å®Œåè¿˜ä¼šåšè¿›ä¸€æ­¥çš„å¤„ç†ï¼š\n å¯¹äºåå®¢æˆ·å æ¯”ä¸º0æˆ–è€…1çš„åˆ†ç®±è¿›è¡Œåˆå¹¶ï¼ˆä¸€ä¸ªåˆ†ç®±å†…ä¸èƒ½å…¨ä¸ºå¥½å®¢æˆ·æˆ–è€…åå®¢æˆ·ï¼‰ å¯¹äºæ ·æœ¬å æ¯”è¶…è¿‡95%çš„ç®±å­è¿›è¡Œåˆ é™¤ æ£€æŸ¥ç¼ºå¤±åˆ†ç®±çš„åå®¢æˆ·æ¯”ä¾‹æ˜¯å¦å’Œéç¼ºå¤±åˆ†ç®±ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰ï¼Œè¿›è¡Œåˆå¹¶  å°ç»“  åˆ†ç®±å¯ä»¥æœ‰æ•ˆå¤„ç†ç¼ºå¤±å€¼å’Œå¼‚å¸¸å€¼ åˆ†ç®±åæ•°æ®å’Œæ¨¡å‹ä¼šæ›´ç¨³å®š åˆ†ç®±å¯ä»¥ç®€åŒ–é€»è¾‘å›å½’æ¨¡å‹ï¼Œé™ä½è¿‡æ‹Ÿåˆé£é™©ï¼Œæé«˜æ³›åŒ–èƒ½åŠ› åˆ†ç®±å°†ç‰¹å¾ç»Ÿä¸€å˜æ¢ä¸ºç±»åˆ«å‹å˜é‡ åˆ†ç®±åå˜é‡æ‰å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„è¯„åˆ†å¡æ ¼å¼    é˜ˆå€¼çš„é€‰æ‹©éœ€è¦æ ¹æ®å®é™…æƒ…å†µç¡®å®šã€‚ \u0026#x21a9;\u0026#xfe0e;\n   ","date":1583227688,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1583227688,"objectID":"1cee129b977dc9746afbf84680375dc3","permalink":"https://keris.github.io/zh/post/credit-score-card/","publishdate":"2020-03-03T17:28:08+08:00","relpermalink":"/zh/post/credit-score-card/","section":"post","summary":"å­¦ä¹ ä¿¡ç”¨è¯„åˆ†å¡æ¨¡å‹çš„å…¨æµç¨‹","tags":["è¯„åˆ†å¡"],"title":"ä¿¡ç”¨è¯„åˆ†å¡æ¨¡å‹","type":"post"},{"authors":[],"categories":[],"content":"RFMæ˜¯ä¸€ç§ç”¨äºåˆ†æå®¢æˆ·ä»·å€¼çš„æ–¹æ³•ï¼Œå¸¸ç”¨äºè¥é”€ã€‚å…¶ä¸­RFMä»£è¡¨ä¸‰ä¸ªç»´åº¦ï¼š\n Recency è¡¨ç¤ºæœ€è¿‘ä¸€æ¬¡å®¢æˆ·è´­ä¹°çš„æ—¶é—´ Frequency è¡¨ç¤ºåœ¨ç»Ÿè®¡å‘¨æœŸå†…å®¢æˆ·è´­ä¹°çš„æ¬¡æ•° Monetary Value è¡¨ç¤ºç»Ÿè®¡å‘¨æœŸå†…å®¢æˆ·æ¶ˆè´¹çš„æ€»é‡‘é¢  æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨RFMæ¨¡å‹åˆ†æä¸€ä¸ªçœŸå®çš„åœ¨çº¿è´­ç‰©æ•°æ®ã€‚\n# Import libraries import pandas as pd import matplotlib.pyplot as plt import squarify from datetime import timedelta import seaborn as sns  # Read dataset online = pd.read_csv('data.csv', encoding='ISO-8859-1') online.head()   .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }  \n  InvoiceNo StockCode Description Quantity InvoiceDate UnitPrice CustomerID Country     0 536365 85123A WHITE HANGING HEART T-LIGHT HOLDER 6 12/1/2010 8:26 2.55 17850.0 United Kingdom   1 536365 71053 WHITE METAL LANTERN 6 12/1/2010 8:26 3.39 17850.0 United Kingdom   2 536365 84406B CREAM CUPID HEARTS COAT HANGER 8 12/1/2010 8:26 2.75 17850.0 United Kingdom   3 536365 84029G KNITTED UNION FLAG HOT WATER BOTTLE 6 12/1/2010 8:26 3.39 17850.0 United Kingdom   4 536365 84029E RED WOOLLY HOTTIE WHITE HEART. 6 12/1/2010 8:26 3.39 17850.0 United Kingdom     online.dtypes  InvoiceNo object StockCode object Description object Quantity int64 InvoiceDate object UnitPrice float64 CustomerID float64 Country object dtype: object  # Convert InvoiceDate from object to datetime format online['InvoiceDate'] = pd.to_datetime(online['InvoiceDate'])  online.dtypes  InvoiceNo object StockCode object Description object Quantity int64 InvoiceDate datetime64[ns] UnitPrice float64 CustomerID float64 Country object dtype: object  # Check how many rows and columns online.shape  (541909, 8)  # Count transactions that don't have a customer id print('{:,} transactions don\\'t have a customer id' .format(online[online.CustomerID.isnull()].shape[0]))  135,080 transactions don't have a customer id  # Check invoice date range print('Transactions timeframe from {} to {}' .format(online.InvoiceDate.min(), online.InvoiceDate.max()))  Transactions timeframe from 2010-12-01 08:26:00 to 2011-12-09 12:50:00  # Drop NA values from online online.dropna(inplace=True)  # Group data by CustomerID # Create TotalSum column for online dataset online['TotalSum'] = online['Quantity'] * online['UnitPrice'] # Create snapshot date snapshot_date = online.InvoiceDate.max() + timedelta(days=1) print(snapshot_date) # Group by CustomerID data = online.groupby(['CustomerID']).agg({ 'InvoiceDate': lambda x: (snapshot_date - x.max()).days, 'InvoiceNo': 'count', 'TotalSum': 'sum' }) data.rename(columns={'InvoiceDate': 'Recency', 'InvoiceNo': 'Frequency', 'TotalSum': 'MonetaryValue'}, inplace=True)  2011-12-10 12:50:00  # Peek first 5 rows data.head()   .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }  \n  Recency Frequency MonetaryValue   CustomerID        12346.0 326 2 0.00   12347.0 2 182 4310.00   12348.0 75 31 1797.24   12349.0 19 73 1757.55   12350.0 310 17 334.40     # Check how many rows and columns data.shape  (4372, 3)  åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ ¹æ®CutomerIDè¿›è¡Œåˆ†ç»„åï¼Œæˆ‘ä»¬èšåˆç”Ÿæˆäº†æ¯ä¸ªå®¢æˆ·æœ€è¿‘ä¸€æ¬¡è´­ä¹°çš„æ—¶é—´ï¼Œè´­ä¹°é¢‘ç‡å’Œæ¶ˆè´¹é¢åº¦ï¼Œå…±4372æ¡è®°å½•ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦å¯¹è¿™ä¸‰ä¸ªç»´åº¦è¿›è¡Œæ‰“åˆ†ï¼Œè¿™å¯ä»¥é€šè¿‡.qcut()æ¥è¿›è¡Œã€‚ä½†åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€çœ‹ç‰¹å¾çš„åˆ†å¸ƒæƒ…å†µã€‚\n# Plot RFM distributions plt.figure(figsize=(12,10)) # Plot distribution of R plt.subplot(3, 1, 1) sns.distplot(data['Recency']) # Plot distribution of F plt.subplot(3, 1, 2) sns.distplot(data['Frequency']) # Plot distribution of M plt.subplot(3, 1, 3) sns.distplot(data['MonetaryValue'])  \u0026lt;matplotlib.axes._subplots.AxesSubplot at 0x1199779b0\u0026gt;  # Calculate R and F groups # Create labels for Recency and Frequency r_labels = range(4, 0, -1) f_labels = range(1, 5) # Assign these labels to 4 equal percentil groups r_groups = pd.qcut(data['Recency'], q=4, labels=r_labels) f_groups = pd.qcut(data['Frequency'], q=4, labels=f_labels) # Create new columns R and F data = data.assign(R=r_groups.values, F=f_groups.values) data.head()   .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }  \n  Recency Frequency MonetaryValue R F   CustomerID          12346.0 326 2 0.00 1 1   12347.0 2 182 4310.00 4 4   12348.0 75 31 1797.24 2 2   12349.0 19 73 1757.55 3 3   12350.0 310 17 334.40 1 1     # Create labels form MonetaryValue m_labels = range(1, 5) m_groups = pd.qcut(data['MonetaryValue'], q=4, labels=m_labels) data = data.assign(M=m_groups.values)  data.head()   .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }  \n  Recency Frequency MonetaryValue R F M   CustomerID           12346.0 326 2 0.00 1 1 1   12347.0 2 182 4310.00 4 4 4   12348.0 75 31 1797.24 2 2 4   12349.0 19 73 1757.55 3 3 4   12350.0 310 17 334.40 1 1 2     # Concat RFM quartile values to create RFM segments def join_rfm(x): return str(x['R']) + str(x['F']) + str(x['M']) data['RFM_segment_concat'] = data.apply(join_rfm, axis=1) rfm = data rfm.head()   .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }  \n  Recency Frequency MonetaryValue R F M RFM_segment_concat   CustomerID            12346.0 326 2 0.00 1 1 1 111   12347.0 2 182 4310.00 4 4 4 444   12348.0 75 31 1797.24 2 2 4 224   12349.0 19 73 1757.55 3 3 4 334   12350.0 310 17 334.40 1 1 2 112     # Count num of unique segments rfm_count_unique = rfm.groupby('RFM_segment_concat')['RFM_segment_concat'].nunique() print(rfm_count_unique.sum())  62  ä»¥ä¸Šç»“æœæ˜¾ç¤ºï¼Œå°†RFMè¿æ¥åœ¨ä¸€èµ·è¿™ç§æ–¹æ³•å…±å½¢æˆ62ä¸ªåˆ’åˆ†ï¼Œä½†åˆ’åˆ†å¤ªå¤šäº†ä¸èƒ½ç”¨äºå®é™…åº”ç”¨ã€‚ä¸‹é¢æˆ‘ä»¬å°è¯•å°†è¿™ä¸‰ä¸ªå€¼ç›¸åŠ ã€‚\n# Calculate RFM_Score rfm['RFM_Score'] = rfm[['R', 'F', 'M']].sum(axis=1) print(rfm['RFM_Score'].head())  CustomerID 12346.0 3.0 12347.0 12.0 12348.0 8.0 12349.0 10.0 12350.0 4.0 Name: RFM_Score, dtype: float64  # Define rfm_level function def rfm_level(df): if df['RFM_Score'] \u0026gt;= 9: return 'Can\\'t Loose Them' elif ((df['RFM_Score'] \u0026gt;= 8) and (df['RFM_Score'] \u0026lt; 9)): return 'Champions' elif ((df['RFM_Score'] \u0026gt;= 7) and (df['RFM_Score'] \u0026lt; 8)): return 'Loyal' elif ((df['RFM_Score'] \u0026gt;= 6) and (df['RFM_Score'] \u0026lt; 7)): return 'Potential' elif ((df['RFM_Score'] \u0026gt;= 5) and (df['RFM_Score'] \u0026lt; 6)): return 'Promising' elif ((df['RFM_Score'] \u0026gt;= 4) and (df['RFM_Score'] \u0026lt; 5)): return 'Needs Attention' else: return 'Require Activation' # Create a new variable RFM_Level rfm['RFM_Level'] = rfm.apply(rfm_level, axis=1) rfm.head()   .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }  \n  Recency Frequency MonetaryValue R F M RFM_segment_concat RFM_Score RFM_Level   CustomerID              12346.0 326 2 0.00 1 1 1 111 3.0 Require Activation   12347.0 2 182 4310.00 4 4 4 444 12.0 Can't Loose Them   12348.0 75 31 1797.24 2 2 4 224 8.0 Champions   12349.0 19 73 1757.55 3 3 4 334 10.0 Can't Loose Them   12350.0 310 17 334.40 1 1 2 112 4.0 Needs Attention     # Calculate average values for each RFM_Level, and return a size of each segment rfm_level_agg = rfm.groupby('RFM_Level').agg({ 'Recency': 'mean', 'Frequency': 'mean', 'MonetaryValue': ['mean', 'count'] }).round(1) # Print the aggregate dataset print(rfm_level_agg)   Recency Frequency MonetaryValue mean mean mean count RFM_Level Can't Loose Them 25.2 195.1 4130.3 1690 Champions 62.7 57.0 974.7 467 Loyal 78.8 39.7 724.2 447 Needs Attention 174.5 13.9 227.1 391 Potential 94.3 28.5 491.8 468 Promising 153.0 21.2 346.8 517 Require Activation 264.8 7.8 109.1 392  ä»ä»¥ä¸Šç»“æœæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œçº¦60%çš„å®¢æˆ·å±äºä¼˜è´¨å®¢æˆ·ï¼ˆå‰ä¸‰ç±»ç”¨æˆ·ï¼‰ã€‚\n# Visualize segments rfm_level_agg.columns = rfm_level_agg.columns.droplevel() rfm_level_agg.columns = ['RecencyMean', 'FrequencyMean', 'MonetaryMean', 'Count']  # Create our plot and resize it fig = plt.gcf() ax = fig.add_subplot() fig.set_size_inches(16, 9) squarify.plot(sizes=rfm_level_agg['Count'], label=list(rfm_level_agg.index), alpha=.6) plt.title('RFM Segments', fontsize=18, fontweight='bold') plt.axis('off') plt.show()  ","date":1582702890,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1582702890,"objectID":"ef833db58e604d147197982b1096f887","permalink":"https://keris.github.io/zh/post/what-is-rfm-model/","publishdate":"2020-02-26T15:41:30+08:00","relpermalink":"/zh/post/what-is-rfm-model/","section":"post","summary":"ç®€è¦è¯´æ˜RFMæ¨¡å‹å¹¶ç»™å‡ºä¸€ä¸ªå®é™…çš„ä½¿ç”¨ä¾‹å­","tags":["RFM"],"title":"RFMæ¨¡å‹åŠå®è·µ","type":"post"},{"authors":["æœåˆ©å¼º"],"categories":["æœºå™¨å­¦ä¹ "],"content":"ç›®å½•  æœ¯è¯­  Logistic function Odds Logit function   é€»è¾‘å›å½’  ä»£ä»·å‡½æ•°æ±‚å¯¼     æœ¯è¯­ é€»è¾‘å›å½’æ¶‰åŠåˆ°ä»¥ä¸‹æœ¯è¯­ï¼š\n Logistic function Odds Logit  Logistic function é€»è¾‘å›å½’ä¸­çš„ Logistic æ­£æ˜¯å‡ºäº Logistic function ï¼Œå®ƒæ˜¯ä¸€ç§ sigmoid function ï¼Œå…¶æ¥å—ä»»æ„å®å€¼ï¼Œè¾“å‡ºä¸€ä¸ª0åˆ°1ä¹‹é—´çš„å€¼ã€‚ æ ‡å‡†çš„ logistic funtion å®šä¹‰å¦‚ä¸‹ï¼š\n$$\\sigma(z) = \\frac{e^z}{e^z + 1} = \\frac{1}{1 + e^{-z}}$$\nå¦‚ä¸‹æ˜¯å®ƒåœ¨åŒºé—´$[-6, 6]$ä¹‹é—´çš„å›¾åƒï¼š\n\nåœ¨é€»è¾‘å›å½’ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å¯¹æ•°å‡ ç‡ï¼ˆlog oddsï¼‰ï¼Œå¹¶å‡å®šå®ƒæ˜¯è¾“å…¥ç‰¹å¾çš„çº¿æ€§ç»„åˆï¼š\n$$z = \\ln \\frac{p(x)}{1 - p(x)}= \\theta_0 + \\theta_1 x_1 + \\theta_2 x_2 = \\theta^T \\cdot x$$\nç”±ä¸Šå¼æˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼Œ\n$$p(x) = \\sigma(z) = \\frac{1}{1 + e^{-\\theta^T \\cdot x}}$$\nåœ¨é€»è¾‘å›å½’æ¨¡å‹ä¸­ï¼Œè¿™é‡Œçš„ $p(x)$ ä¸ºå› å˜é‡åœ¨æˆåŠŸæƒ…å½¢ä¸‹çš„æ¦‚ç‡ï¼Œå³ $p(y=1 \\mid x)$ã€‚\nOdds å¦‚æœ $p$ è¡¨ç¤ºä¸€ä¸ªäº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡ï¼Œé‚£ä¹ˆoddså®šä¹‰ä¸º\n$$\\text{odds} = \\frac{p}{1 - p}$$ ä¹Ÿå°±æ˜¯è¯´ï¼Œoddsä¸ºå‘ç”Ÿçš„æ¦‚ç‡é™¤ä»¥ä¸å‘ç”Ÿçš„æ¦‚ç‡ï¼Œäº¦å¯ä»¥è¯´ä¸ºæˆåŠŸçš„æ¦‚ç‡é™¤ä»¥å¤±è´¥çš„æ¦‚ç‡ã€‚\nLogit function Logitä¸ºLog odds, logit function å®šä¹‰ä¸º logistic functionçš„é€†ï¼Œå³ $g = \\sigma^{-1}$ã€‚æ˜¾è€Œæ˜“è§ï¼Œæˆ‘ä»¬æœ‰\n$$g(p(x)) = \\sigma_{-1}(p(x)) = \\text{logit}\\,p(x) = \\ln(\\frac{p(x)}{1 - p(x)}) = \\theta^T \\cdot x$$\né€»è¾‘å›å½’ é€»è¾‘å›å½’æ˜¯ä¸€ä¸ªé‡è¦çš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œå…¶ç›®æ ‡æ˜¯åŸºäºç»™å®šçš„æ•°æ®$x$è¾“å‡ºéšæœºå˜é‡$y$ä¸º0æˆ–1çš„æ¦‚ç‡ã€‚\nè€ƒè™‘ç”±$\\theta$å‚æ•°åŒ–çš„çº¿æ€§æ¨¡å‹ï¼Œ\n$$h_\\theta(x) = \\frac{1}{1 + e^{-\\theta^T \\cdot x}} = \\text{Pr}(y = 1 \\mid x;\\theta)$$\nä»è€Œï¼Œ$\\text{Pr}(y=0 \\mid x;\\theta) = 1 - h_\\theta(x)$ã€‚\nå› ä¸º$y \\in \\{0, 1 \\}$ï¼Œæˆ‘ä»¬æœ‰\n$$\\text{Pr}(y \\mid x;\\theta) = h_\\theta(x)^y (1 - h_\\theta(x))^{1 - y} $$\nä¼¼ç„¶å‡½æ•°ä¸º\n$$\\begin{aligned} L(\\theta \\mid x) \u0026amp;= \\Pr(Y\\mid X;\\theta) \\\\\n\u0026amp;= \\prod_i \\Pr(y^{(i)} \\mid x^{(i)};\\theta) \\\\\n\u0026amp;= \\prod_i h_\\theta(x^{(i)})^{y^{(i)}}(1-h_\\theta(x^{(i)}))^{1-y^{(i)}} \\end{aligned}$$\nä¸€èˆ¬åœ°ï¼Œæˆ‘ä»¬æœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼Œ\n$$\\log L(\\theta \\mid x) = \\sum_{i=1}^{m}\\log \\Pr(y^{(i)} \\mid x^{(i)};\\theta)$$\nå®šä¹‰ä»£ä»·å‡½æ•°å¦‚ä¸‹ï¼š\n$$J(\\theta) = -\\frac{1}{m} \\log L(\\theta \\mid x) = -\\frac{1}{m} \\sum_i^m (y^{(i)} \\log h_\\theta(x^{(i)}) + (1 - y^{(i)})(1 - h_\\theta(x^{(i)})))$$\nå®¹æ˜“çœ‹åˆ°ï¼Œæˆ‘ä»¬æœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶å‡½æ•°å°±æ˜¯æœ€å°åŒ–ä»£ä»·å‡½æ•° $J(\\theta)$ã€‚åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æ¢¯åº¦ä¸‹é™æœ€å°åŒ–ä»£ä»·å‡½æ•°ã€‚\nä»£ä»·å‡½æ•°æ±‚å¯¼ ä¸‹é¢æˆ‘ä»¬å¯¹ä»£ä»·å‡½æ•°$J(\\theta)$å¯¹$\\theta$è¿›è¡Œæ±‚å¯¼ï¼Œæˆ‘ä»¬å…ˆè€ƒè™‘åœ¨ä¸€ä¸ªæ ·æœ¬ä¸Šçš„ä»£ä»·å‡½æ•°\n$$J_1(\\theta) = -y \\log h_\\theta(x) - (1 - y)(1 - h_\\theta(x))$$\nç°åœ¨å¯¹$J_1(\\theta)$å¯¹$\\theta$è¿›è¡Œæ±‚å¯¼ï¼š\næ³¨æ„åˆ°$\\frac{d\\sigma(z)}{dz} = \\sigma(z) (1 - \\sigma(z))$, æˆ‘ä»¬æœ‰\n$$\\begin{aligned}\\frac{\\partial}{\\partial \\theta_j} J_1(\\theta) \u0026amp;= -y \\frac{1}{h_\\theta(x)} h_\\theta(x) (1 - h_\\theta(x)) x_j - (1 - y) \\frac{1}{1 - h_\\theta(x)} (-1) h_\\theta(x) (1 - h_\\theta(x)) x_j \\\\ \u0026amp;= (h_\\theta(x) - y) x_j\\end{aligned} $$\næœ‰äº†ä»¥ä¸Šç»“æœï¼Œæˆ‘ä»¬æœ‰\n$$\\frac{\\partial}{\\partial \\theta_j} J(\\theta) = \\frac{1}{m}\\sum_i^m [h_\\theta(x^{(i)}) - y^{(i)}]x_j^{(i)}$$\n","date":1578991642,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1579496437,"objectID":"aebccbb495f02050f938f27e4bd41ef9","permalink":"https://keris.github.io/zh/post/logistic-regression/","publishdate":"2020-01-14T16:47:22+08:00","relpermalink":"/zh/post/logistic-regression/","section":"post","summary":"ç†è§£é€»è¾‘å›å½’ä¸­æ¶‰åŠçš„æœ¯è¯­ä»¥åŠä»æœ€å¤§ä¼¼ç„¶åˆ°æœ€å°åŒ–ä»£ä»·å‡½æ•°","tags":["logistic-regression","é€»è¾‘å›å½’"],"title":"é€»è¾‘å›å½’ï¼ˆLogistic Regressionï¼‰","type":"post"},{"authors":[],"categories":[],"content":"åœ¨gitçš„æ—¥å¸¸ä½¿ç”¨ä¸­æ›´æ”¹æäº¤çš„ä½œè€…åå’Œé‚®ç®±æ˜¯ä¸€ä¸ªååˆ†å¸¸è§çš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œå½“ä½ å…‹éš†äº†ä¸€ä¸ªé¡¹ç›®ï¼Œå¦‚æœä½ æ²¡æœ‰è¿›è¡Œä»»ä½•è®¾ç½®ï¼Œæ­¤æ—¶æäº¤çš„ä½œè€…å’Œé‚®ä»¶å°†ä½¿ç”¨å…¨å±€é€‰é¡¹ï¼Œè¿™å¯èƒ½ä¸æ˜¯ä½ æ‰€è¦çš„ã€‚\né€šè¿‡æœ¬æ–‡ä½ å°†äº†è§£ï¼š\n å¦‚ä½•é…ç½®gitä½¿ç”¨çš„æäº¤è€…ç”¨æˆ·åå’Œé‚®ç®± å¦‚ä½•æ›´æ”¹æœ€è¿‘ä¸€æ¬¡æäº¤çš„ä½œè€…åå’Œé‚®ä»¶ æ‰¹é‡æ›´æ”¹æäº¤çš„ä½œè€…åå’Œé‚®ä»¶  é…ç½®æäº¤è€…ç”¨æˆ·åå’Œé‚®ç®± ä½ æœ‰ä¸¤ç§æ–¹å¼è¿›è¡Œè®¾ç½®ï¼Œä¸€æ˜¯å…¨å±€é…ç½®ï¼ŒäºŒæ˜¯ä¸ºæ¯ä¸ªrepoå•ç‹¬é…ç½®ã€‚\nå…¨å±€åœ°æ›´æ”¹æäº¤è€…ç”¨æˆ·åå’Œé‚®ç®± ä½¿ç”¨git configå¹¶--globalé€‰é¡¹è¿›è¡Œå…¨å±€è®¾ç½®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n$ git config --global user.name \u0026quot;Du Liqiang\u0026quot; $ git config --global user.email \u0026quot;dlq137@gmail.com\u0026quot;  è®¾ç½®å®Œæ¯•åï¼Œåç»­çš„æäº¤å°†ä½¿ç”¨ä»¥ä¸Šæä¾›çš„ä¿¡æ¯ã€‚\nä¸ºæŸä¸ªrepoå•ç‹¬é…ç½® å…¨å±€é€‰é¡¹å¯èƒ½å¹¶ä¸é€‚ç”¨äºæŸä¸ªrepoï¼Œæ­¤æ—¶å°±éœ€è¦å•ç‹¬è®¾ç½®ï¼Œä½¿ç”¨git configä½†çœç•¥--globalé€‰é¡¹ï¼Œå¦‚ä¸‹ï¼š\n$ git config user.name \u0026quot;Du Liqiang\u0026quot; $ git config user.email \u0026quot;dlq137@gmail.com\u0026quot;  è¿™é‡Œçš„è®¾ç½®å°†è¦†ç›–å…¨å±€é€‰é¡¹ï¼Œå¹¶ä¸”åªåº”ç”¨äºå½“å‰çš„repoã€‚\næ›´æ”¹æœ€è¿‘ä¸€æ¬¡æäº¤çš„ä½œè€…ç”¨æˆ·åå’Œé‚®ç®± å¦‚æœä½ åˆšåšäº†ä¸€æ¬¡æäº¤ï¼Œå‘ç°ç”¨æˆ·åå’Œé‚®ç®±å¹¶ä¸æ˜¯æ‰€è¦çš„ï¼Œä½ å¯ä»¥ä½¿ç”¨--amendé€‰é¡¹é‡æ–°æäº¤ï¼š\n$ git commit --amend --author=\u0026quot;Du Liqiang \u0026lt;dlq137@gmail.com\u0026gt;\u0026quot;  æ›´æ”¹å¤šæ¬¡æäº¤çš„ä½œè€…ç”¨æˆ·åå’Œé‚®ç®± è¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦å€ŸåŠ©å¼ºå¤§çš„rebaseå‘½ä»¤ï¼Œé¦–å…ˆæˆ‘ä»¬æ‰¾åˆ°ä¸Šä¸€æ¬¡â€œå¥½â€çš„æäº¤1ï¼Œå¹¶å‡è®¾å…¶æäº¤hashä¸º0ad14fa5ï¼Œæ‰§è¡Œï¼š\n$ git rebase -i -p 0ad14fa5  æ­¤æ—¶æˆ‘ä»¬ä¼šè¿›å…¥ä¸€ä¸ªç¼–è¾‘å™¨ï¼Œå°†é‚£äº›éœ€è¦ç¼–è¾‘çš„æäº¤å…¨æ ‡è®°ä¸ºeditï¼Œæ¥ä¸‹æ¥gitä¼šæŒ‡å¯¼ä½ å®Œæˆæ¯æ¬¡æäº¤çš„ç¼–è¾‘ï¼Œä½ éœ€è¦åšçš„å°±æ˜¯æ‰§è¡Œï¼š\n$ git commit --amend --author=\u0026quot;Du Liqiang \u0026lt;dlq137@gmail.com\u0026gt; --no-edit $ git rebase --continue  ä½¿ç”¨git filter-branchæ‰¹é‡æ›´æ”¹ é™¤äº†ä»¥ä¸Šäº¤äº’å¼çš„æ›´æ”¹æ–¹æ³•ï¼Œå¦ä¸€ç§æ–¹æ³•æ˜¯å€ŸåŠ©gitçš„filter-branchå‘½ä»¤ï¼Œå…¶å…è®¸ä½ ä½¿ç”¨ä¸€ä¸ªscriptæ‰¹é‡å¤„ç†å¤§é‡çš„æäº¤ã€‚\nå¦‚ä¸‹å‘½ä»¤ç­›é€‰æäº¤é‚®ç®±ä¸ºWRONG_EMAILçš„æäº¤ï¼Œå¹¶å°†å…¶ç”¨æˆ·åå’Œé‚®ç®±åˆ†åˆ«è®¾ç½®ä¸ºNEW_NAMEå’ŒNEW_EMAILå¯¹åº”çš„å€¼ã€‚\n$ git filter-branch --env-filter ' WRONG_EMAIL=\u0026quot;wrong@example.com\u0026quot; NEW_NAME=\u0026quot;New Name Value\u0026quot; NEW_EMAIL=\u0026quot;correct@example.com\u0026quot; if [ \u0026quot;$GIT_COMMITTER_EMAIL\u0026quot; = \u0026quot;$WRONG_EMAIL\u0026quot; ] then export GIT_COMMITTER_NAME=\u0026quot;$NEW_NAME\u0026quot; export GIT_COMMITTER_EMAIL=\u0026quot;$NEW_EMAIL\u0026quot; fi if [ \u0026quot;$GIT_AUTHOR_EMAIL\u0026quot; = \u0026quot;$WRONG_EMAIL\u0026quot; ] then export GIT_AUTHOR_NAME=\u0026quot;$NEW_NAME\u0026quot; export GIT_AUTHOR_EMAIL=\u0026quot;$NEW_EMAIL\u0026quot; fi ' --tag-name-filter cat -- --branches --tags  å‚è€ƒ  https://www.git-tower.com/learn/git/faq/change-author-name-email    è¯¥æ¬¡æäº¤ä¹‹å‰çš„æäº¤å…·æœ‰æ­£ç¡®çš„ç”¨æˆ·åå’Œé‚®ç®±ï¼Œå…¶åçš„éœ€è¦è¿›è¡Œæ›´æ”¹ã€‚ \u0026#x21a9;\u0026#xfe0e;\n  ","date":1573120043,"expirydate":-62135596800,"kind":"page","lang":"zh","lastmod":1573120043,"objectID":"9f6fd127ef1ad95f23bfd5dc1c97aaa2","permalink":"https://keris.github.io/zh/post/change-author-name-email/","publishdate":"2019-11-07T17:47:23+08:00","relpermalink":"/zh/post/change-author-name-email/","section":"post","summary":"åœ¨gitçš„æ—¥å¸¸ä½¿ç”¨ä¸­æ›´æ”¹æäº¤çš„ä½œè€…åå’Œé‚®ç®±æ˜¯ä¸€ä¸ªååˆ†å¸¸è§çš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œå½“ä½ å…‹éš†äº†ä¸€ä¸ªé¡¹ç›®ï¼Œå¦‚æœä½ æ²¡æœ‰è¿›è¡Œä»»ä½•è®¾ç½®ï¼Œæ­¤æ—¶æäº¤çš„ä½œè€…å’Œé‚®ä»¶å°†ä½¿ç”¨å…¨å±€é€‰é¡¹ï¼Œè¿™å¯èƒ½ä¸æ˜¯ä½ æ‰€è¦çš„ã€‚\n","tags":["git","change-author"],"title":"æ›´æ”¹gitæäº¤ä¸­çš„ä½œè€…å’Œé‚®ä»¶ä¿¡æ¯","type":"post"}]